import{a as ur}from"./chunk-SJVVKRV2.js";import{a as pr,b as gr}from"./chunk-DERUADVW.js";import{a as O,c as ue,e as Be,f as yr}from"./chunk-L5U5ISPN.js";import{a as Ki,b as be,c as at,d as Yi,e as Xi,f as lt,g as qt,h as qi,i as Gi,k as Zi,l as Ji,m as Qi,n as er,o as tr,p as ke,q as ir,r as rr,s as sr,t as vr,u as mr,v as Sr}from"./chunk-X67ZFC2S.js";import{A as dr,B as ht,C as ze,D as Re,E as fr,F as ei,H as E,I as ti,e as zi,f as ji,l as $i,m as K,n as Gt,p as Zt,q as Jt,r as nr,s as ct,t as or,u as ar,v as Qt,x as lr,y as cr,z as hr}from"./chunk-442CTE2H.js";import{$a as Fi,A as me,Aa as j,Ab as ye,B as et,Bb as B,Cb as q,D as ee,Db as _e,E as Wt,Ea as Oi,Eb as Bt,F as A,Fa as xi,Fb as zt,G as k,Hb as Le,J as xe,Jb as re,K as Vt,Kb as st,L as Ei,Lb as jt,Mb as nt,Nb as Ui,Ob as $t,Pb as Ne,Q as Se,Qb as He,R as tt,Sa as Mi,Va as ie,Wb as we,X as I,Xa as J,Xb as Wi,Y as Z,Ya as Nt,Yb as Q,Z as x,Zb as Vi,_a as Ue,a as y,aa as f,b as ae,ba as N,cb as V,cc as Li,d as Oe,da as te,db as H,e as Ge,eb as he,fa as l,g as le,ga as Pi,hc as Ni,ia as it,j as T,jc as $,k as Ze,ka as Me,kb as M,kc as Kt,l as Ci,la as Fe,lb as de,mc as Yt,n as Je,na as W,nc as ot,o as p,oa as C,p as v,pb as Ht,qa as Ai,rc as Hi,s as Qe,sa as Ti,sc as Xt,t as Di,u as Ii,ua as Lt,v as b,vb as We,wb as Ve,x as ce,ya as rt,yc as Bi}from"./chunk-4PHDW4NF.js";var Is=O.object({id:O.number(),title:O.string(),contentPreview:O.string(),author:O.string(),likes:O.number(),comments:O.number(),likedByMe:O.boolean(),createdByMe:O.boolean(),headerImageUrl:O.string().optional()}),Es=O.array(Is),Ps=O.object({data:Es,pageIndex:O.number(),pageSize:O.number(),totalCount:O.number(),maxPageSize:O.number()}),dt=class s{#e=l(lt);getBlogPosts(){return this.#e.get(`${ue.serviceUrl}/entries`).pipe(b(i=>Ps.parse(i)))}static \u0275fac=function(o){return new(o||s)};static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})};var ut=class s{handleError(i){let o=i.message?i.message:i.toString();this.postCustomData(i,o),ue.production?window.location.href="/error":console.log("ERROR ->",i)}postCustomData(i,o){return Oe(this,null,function*(){try{yield fetch(`${ue.serviceUrl}/api/report-error/client-fatal`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({"client-message":o||"","client-error":i.stack||""})})}catch(e){console.error("Failed to report error:",e)}})}static \u0275fac=function(o){return new(o||s)};static \u0275prov=f({token:s,factory:s.\u0275fac})};var _r=()=>({provide:Ai,useClass:ut});var wr=[{path:"error",component:Error}];var ft=class s{static \u0275fac=function(o){return new(o||s)};static \u0275cmp=V({type:s,selectors:[["PageNotFound"]],decls:2,vars:0,template:function(o,e){o&1&&(Bt(0,"h1"),Q(1,"Diese Seite konnte leider nicht gefunden werden."),zt())},encapsulation:2,changeDetection:0})};var kr=[{path:"**",component:ft}];var Rr={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bits:6};var Cr={parse:function(i,o){return As(i,Rr,o)},stringify:function(i,o){return Ts(i,Rr,o)}};function As(s,i,o){var e;if(o===void 0&&(o={}),!i.codes){i.codes={};for(var t=0;t<i.chars.length;++t)i.codes[i.chars[t]]=t}if(!o.loose&&s.length*i.bits&7)throw new SyntaxError("Invalid padding");for(var r=s.length;s[r-1]==="=";)if(--r,!o.loose&&!((s.length-r)*i.bits&7))throw new SyntaxError("Invalid padding");for(var n=new((e=o.out)!=null?e:Uint8Array)(r*i.bits/8|0),a=0,c=0,h=0,d=0;d<r;++d){var u=i.codes[s[d]];if(u===void 0)throw new SyntaxError("Invalid character "+s[d]);c=c<<i.bits|u,a+=i.bits,a>=8&&(a-=8,n[h++]=255&c>>a)}if(a>=i.bits||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return n}function Ts(s,i,o){o===void 0&&(o={});for(var e=o,t=e.pad,r=t===void 0?!0:t,n=(1<<i.bits)-1,a="",c=0,h=0,d=0;d<s.length;++d)for(h=h<<8|255&s[d],c+=8;c>i.bits;)c-=i.bits,a+=i.chars[n&h>>c];if(c&&(a+=i.chars[n&h<<i.bits-c]),r)for(;a.length*i.bits&7;)a+="=";return a}var pt=class{},ri=class{constructor(i){this.passedConfigs=i}loadConfigs(){return Array.isArray(this.passedConfigs)?p(this.passedConfigs):p([this.passedConfigs])}};function Os(s){if(!s?.config)throw new Error("No config provided!");return new ri(s.config)}var Dr=new te("PASSED_CONFIG"),Tr=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),xs=(()=>{let i=class i{logError(e,...t){console.error(e,...t)}logWarning(e,...t){console.warn(e,...t)}logDebug(e,...t){console.debug(e,...t)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),je=(function(s){return s[s.None=0]="None",s[s.Debug=1]="Debug",s[s.Warn=2]="Warn",s[s.Error=3]="Error",s})(je||{}),_=(()=>{let i=class i{constructor(){this.abstractLoggerService=l(Tr)}logError(e,t,...r){if(this.loggingIsTurnedOff(e))return;let{configId:n}=e,a=this.isObject(t)?JSON.stringify(t):t;r&&r.length?this.abstractLoggerService.logError(`[ERROR] ${n} - ${a}`,...r):this.abstractLoggerService.logError(`[ERROR] ${n} - ${a}`)}logWarning(e,t,...r){if(!this.logLevelIsSet(e)||this.loggingIsTurnedOff(e)||!this.currentLogLevelIsEqualOrSmallerThan(e,je.Warn))return;let{configId:n}=e,a=this.isObject(t)?JSON.stringify(t):t;r&&r.length?this.abstractLoggerService.logWarning(`[WARN] ${n} - ${a}`,...r):this.abstractLoggerService.logWarning(`[WARN] ${n} - ${a}`)}logDebug(e,t,...r){if(!e||!this.logLevelIsSet(e)||this.loggingIsTurnedOff(e)||!this.currentLogLevelIsEqualOrSmallerThan(e,je.Debug))return;let{configId:n}=e,a=this.isObject(t)?JSON.stringify(t):t;r&&r.length?this.abstractLoggerService.logDebug(`[DEBUG] ${n} - ${a}`,...r):this.abstractLoggerService.logDebug(`[DEBUG] ${n} - ${a}`)}currentLogLevelIsEqualOrSmallerThan(e,t){let{logLevel:r}=e||{};return r?r<=t:!1}logLevelIsSet(e){let{logLevel:t}=e||{};return t===null?!1:t!==void 0}loggingIsTurnedOff(e){let{logLevel:t}=e||{};return t===je.None}isObject(e){return Object.prototype.toString.call(e)==="[object Object]"}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),F=(function(s){return s[s.ConfigLoaded=0]="ConfigLoaded",s[s.CheckingAuth=1]="CheckingAuth",s[s.CheckingAuthFinished=2]="CheckingAuthFinished",s[s.CheckingAuthFinishedWithError=3]="CheckingAuthFinishedWithError",s[s.ConfigLoadingFailed=4]="ConfigLoadingFailed",s[s.CheckSessionReceived=5]="CheckSessionReceived",s[s.UserDataChanged=6]="UserDataChanged",s[s.NewAuthenticationResult=7]="NewAuthenticationResult",s[s.TokenExpired=8]="TokenExpired",s[s.IdTokenExpired=9]="IdTokenExpired",s[s.SilentRenewStarted=10]="SilentRenewStarted",s[s.SilentRenewFailed=11]="SilentRenewFailed",s})(F||{}),fe=(()=>{let i=class i{constructor(){this.notify=new Ci(1)}fireEvent(e,t){this.notify.next({type:e,value:t})}registerForEvents(){return this.notify.asObservable()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Or=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Ms=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.abstractSecurityStorage=l(Or)}read(e,t){let{configId:r}=t;if(!r)return this.loggerService.logDebug(t,`Wanted to read '${e}' but configId was '${r}'`),null;if(!this.hasStorage())return this.loggerService.logDebug(t,`Wanted to read '${e}' but Storage was undefined`),null;let n=this.abstractSecurityStorage.read(r);return n?JSON.parse(n):null}write(e,t){let{configId:r}=t;return r?this.hasStorage()?(e=e||null,this.abstractSecurityStorage.write(r,JSON.stringify(e)),!0):(this.loggerService.logDebug(t,"Wanted to write but Storage was falsy"),!1):(this.loggerService.logDebug(t,`Wanted to write but configId was '${r}'`),!1)}remove(e,t){return this.hasStorage()?(this.abstractSecurityStorage.remove(e),!0):(this.loggerService.logDebug(t,`Wanted to remove '${e}' but Storage was falsy`),!1)}clear(e){return this.hasStorage()?(this.abstractSecurityStorage.clear(),!0):(this.loggerService.logDebug(e,"Wanted to clear storage but Storage was falsy"),!1)}hasStorage(){return typeof Storage<"u"}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),P=(()=>{let i=class i{constructor(){this.browserStorageService=l(Ms)}read(e,t){return(this.browserStorageService.read(e,t)||{})[e]}write(e,t,r){let n=this.browserStorageService.read(e,r)||{};return n[e]=t,this.browserStorageService.write(n,r)}remove(e,t){let r=this.browserStorageService.read(e,t)||{};delete r[e],this.browserStorageService.write(r,t)}clear(e){this.browserStorageService.clear(e)}resetStorageFlowData(e){this.remove("session_state",e),this.remove("storageSilentRenewRunning",e),this.remove("storageCodeFlowInProgress",e),this.remove("codeVerifier",e),this.remove("userData",e),this.remove("storageCustomParamsAuthRequest",e),this.remove("access_token_expires_at",e),this.remove("storageCustomParamsRefresh",e),this.remove("storageCustomParamsEndSession",e),this.remove("reusable_refresh_token",e)}resetAuthStateInStorage(e){this.remove("authzData",e),this.remove("reusable_refresh_token",e),this.remove("authnResult",e)}getAccessToken(e){return this.read("authzData",e)}getIdToken(e){return this.read("authnResult",e)?.id_token}getRefreshToken(e){let t=this.read("authnResult",e)?.refresh_token;return!t&&e.allowUnsafeReuseRefreshToken?this.read("reusable_refresh_token",e):t}getAuthenticationResult(e){return this.read("authnResult",e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),xr=(()=>{let i=class i{extractJwk(e,t,r=!0){if(e.length===0)throw Fs;let n=e.filter(a=>t?.kid?a.kid===t.kid:!0).filter(a=>t?.use?a.use===t.use:!0).filter(a=>t?.kty?a.kty===t.kty:!0);if(n.length===0&&r)throw Us;if(n.length>1&&t==null)throw Ws;return n}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();function ni(s){return xr.name+": "+s}var Fs={name:ni("InvalidArgumentError"),message:"Array of keys was empty. Unable to extract"},Us={name:ni("NoMatchingKeysError"),message:"No key found matching the spec"},Ws={name:ni("SeveralMatchingKeysError"),message:"More than one key found. Please use spec to filter"},Ir=3,vt=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.document=l(C)}getTokenExpirationDate(e){if(!Object.prototype.hasOwnProperty.call(e,"exp"))return new Date(new Date().toUTCString());let t=new Date(0);return t.setUTCSeconds(e.exp),t}getSigningInputFromToken(e,t,r){if(!this.tokenIsValid(e,r))return"";let n=this.getHeaderFromToken(e,t,r),a=this.getPayloadFromToken(e,t,r);return[n,a].join(".")}getHeaderFromToken(e,t,r){return this.tokenIsValid(e,r)?this.getPartOfToken(e,0,t):{}}getPayloadFromToken(e,t,r){return r?this.tokenIsValid(e,r)?this.getPartOfToken(e,1,t):{}:{}}getSignatureFromToken(e,t,r){return this.tokenIsValid(e,r)?this.getPartOfToken(e,2,t):{}}getPartOfToken(e,t,r){let n=this.extractPartOfToken(e,t);if(r)return n;let a=this.urlBase64Decode(n);return JSON.parse(a)}urlBase64Decode(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("Illegal base64url string!")}let r=typeof this.document.defaultView<"u"?this.document.defaultView?.atob(t):Buffer.from(t,"base64").toString("binary");if(!r)return"";try{return decodeURIComponent(r.split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))}catch{return r}}tokenIsValid(e,t){return e?e.includes(".")?e.split(".").length!==Ir?(this.loggerService.logError(t,`token '${e}' is not valid --> token has to have exactly ${Ir-1} dots`),!1):!0:(this.loggerService.logError(t,`token '${e}' is not valid --> no dots included`),!1):(this.loggerService.logError(t,`token '${e}' is not valid --> token falsy`),!1)}extractPartOfToken(e,t){return e.split(".")[t]}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),oi=(()=>{let i=class i{constructor(){this.document=l(C)}getCrypto(){return this.document.defaultView?.crypto||this.document.defaultView?.msCrypto}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Vs=(()=>{let i=class i{constructor(){this.cryptoService=l(oi)}importVerificationKey(e,t){return this.cryptoService.getCrypto().subtle.importKey("jwk",e,t,!1,["verify"])}verifyKey(e,t,r,n){return this.cryptoService.getCrypto().subtle.verify(e,t,r,new TextEncoder().encode(n))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Mr=(()=>{let i=class i{constructor(){this.cryptoService=l(oi)}generateCodeChallenge(e){return this.calcHash(e).pipe(b(t=>this.base64UrlEncode(t)))}generateAtHash(e,t){return this.calcHash(e,t).pipe(b(r=>{let n=r.substr(0,r.length/2);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}))}calcHash(e,t="SHA-256"){let r=new TextEncoder().encode(e);return Je(this.cryptoService.getCrypto().subtle.digest(t,r)).pipe(b(n=>{let a=n,c=Array.from(new Uint8Array(a));return this.toHashString(c)}))}toHashString(e){let t="";for(let r of e)t+=String.fromCharCode(r);return t}base64UrlEncode(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();function Ls(s){switch(s.charAt(0)){case"R":return{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"};case"E":return s.includes("256")?{name:"ECDSA",hash:"SHA-256"}:s.includes("384")?{name:"ECDSA",hash:"SHA-384"}:null;default:return null}}function Ns(s){switch(s.charAt(0)){case"R":return"RSA";case"E":return"EC";default:throw new Error("Cannot infer kty from alg: "+s)}}function Hs(s){switch(s.charAt(0)){case"R":return s.includes("256")?{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"}:s.includes("384")?{name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"}:s.includes("512")?{name:"RSASSA-PKCS1-v1_5",hash:"SHA-512"}:null;case"E":return s.includes("256")?{name:"ECDSA",namedCurve:"P-256"}:s.includes("384")?{name:"ECDSA",namedCurve:"P-384"}:null;default:return null}}var mt=(()=>{let i=class i{constructor(){this.keyAlgorithms=["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","PS256","PS384","PS512"],this.tokenHelperService=l(vt),this.loggerService=l(_),this.jwkExtractor=l(xr),this.jwkWindowCryptoService=l(Vs),this.jwtWindowCryptoService=l(Mr)}hasIdTokenExpired(e,t,r){let n=this.tokenHelperService.getPayloadFromToken(e,!1,t);return!this.validateIdTokenExpNotExpired(n,t,r)}validateIdTokenExpNotExpired(e,t,r){let n=this.tokenHelperService.getTokenExpirationDate(e);if(r=r||0,!n)return!1;let a=n.valueOf(),c=this.calculateNowWithOffset(r),h=a>c;return this.loggerService.logDebug(t,`Has idToken expired: ${!h} --> expires in ${this.millisToMinutesAndSeconds(a-c)} , ${new Date(a).toLocaleTimeString()} > ${new Date(c).toLocaleTimeString()}`),h}validateAccessTokenNotExpired(e,t,r){if(!e)return!0;r=r||0;let n=e.valueOf(),a=this.calculateNowWithOffset(r),c=n>a;return this.loggerService.logDebug(t,`Has accessToken expired: ${!c} --> expires in ${this.millisToMinutesAndSeconds(n-a)} , ${new Date(n).toLocaleTimeString()} > ${new Date(a).toLocaleTimeString()}`),c}validateRequiredIdToken(e,t){let r=!0;return Object.prototype.hasOwnProperty.call(e,"iss")||(r=!1,this.loggerService.logWarning(t,"iss is missing, this is required in the id_token")),Object.prototype.hasOwnProperty.call(e,"sub")||(r=!1,this.loggerService.logWarning(t,"sub is missing, this is required in the id_token")),Object.prototype.hasOwnProperty.call(e,"aud")||(r=!1,this.loggerService.logWarning(t,"aud is missing, this is required in the id_token")),Object.prototype.hasOwnProperty.call(e,"exp")||(r=!1,this.loggerService.logWarning(t,"exp is missing, this is required in the id_token")),Object.prototype.hasOwnProperty.call(e,"iat")||(r=!1,this.loggerService.logWarning(t,"iat is missing, this is required in the id_token")),r}validateIdTokenIatMaxOffset(e,t,r,n){if(r)return!0;if(!Object.prototype.hasOwnProperty.call(e,"iat"))return!1;let a=new Date(0);a.setUTCSeconds(e.iat),t=t||0;let h=new Date(new Date().toUTCString()).valueOf()-a.valueOf(),d=t*1e3;return this.loggerService.logDebug(n,`validate id token iat max offset ${h} < ${d}`),h>0?h<d:-h<d}validateIdTokenNonce(e,t,r,n){return!((e.nonce===void 0||r)&&t===i.refreshTokenNoncePlaceholder)&&e.nonce!==t?(this.loggerService.logDebug(n,"Validate_id_token_nonce failed, dataIdToken.nonce: "+e.nonce+" local_nonce:"+t),!1):!0}validateIdTokenIss(e,t,r){return e.iss!==t?(this.loggerService.logDebug(r,"Validate_id_token_iss failed, dataIdToken.iss: "+e.iss+" authWellKnownEndpoints issuer:"+t),!1):!0}validateIdTokenAud(e,t,r){return Array.isArray(e.aud)?e.aud.includes(t)?!0:(this.loggerService.logDebug(r,"Validate_id_token_aud array failed, dataIdToken.aud: "+e.aud+" client_id:"+t),!1):e.aud!==t?(this.loggerService.logDebug(r,"Validate_id_token_aud failed, dataIdToken.aud: "+e.aud+" client_id:"+t),!1):!0}validateIdTokenAzpExistsIfMoreThanOneAud(e){return e?!(Array.isArray(e.aud)&&e.aud.length>1&&!e.azp):!1}validateIdTokenAzpValid(e,t){return e?.azp?e.azp===t:!0}validateStateFromHashCallback(e,t,r){return e!==t?(this.loggerService.logDebug(r,"ValidateStateFromHashCallback failed, state: "+e+" local_state:"+t),!1):!0}validateSignatureIdToken(e,t,r){if(!e)return p(!0);if(!t||!t.keys)return p(!1);let n=this.tokenHelperService.getHeaderFromToken(e,!1,r);if(Object.keys(n).length===0&&n.constructor===Object)return this.loggerService.logWarning(r,"id token has no header data"),p(!1);let a=n.kid,c=n.alg,h=t.keys,d,u;if(!this.keyAlgorithms.includes(c))return this.loggerService.logWarning(r,"alg not supported",c),p(!1);let g=Ns(c),S="sig";try{d=a?this.jwkExtractor.extractJwk(h,{kid:a,kty:g,use:S},!1):this.jwkExtractor.extractJwk(h,{kty:g,use:S},!1),d.length===0&&(d=a?this.jwkExtractor.extractJwk(h,{kid:a,kty:g}):this.jwkExtractor.extractJwk(h,{kty:g})),u=d[0]}catch(z){return this.loggerService.logError(r,z),p(!1)}let w=Hs(c),m=this.tokenHelperService.getSigningInputFromToken(e,!0,r),X=this.tokenHelperService.getSignatureFromToken(e,!0,r);return Je(this.jwkWindowCryptoService.importVerificationKey(u,w)).pipe(ce(z=>{let oe=Cr.parse(X,{loose:!0}),Te=Ls(c);return Je(this.jwkWindowCryptoService.verifyKey(Te,z,oe,m))}),x(z=>{z||this.loggerService.logWarning(r,"incorrect Signature, validation failed for id_token")}))}validateIdTokenAtHash(e,t,r,n){this.loggerService.logDebug(n,"at_hash from the server:"+t);let a="SHA-256";return r.includes("384")?a="SHA-384":r.includes("512")&&(a="SHA-512"),this.jwtWindowCryptoService.generateAtHash(""+e,a).pipe(ce(c=>(this.loggerService.logDebug(n,"at_hash client validation not decoded:"+c),c===t?p(!0):this.jwtWindowCryptoService.generateAtHash(""+decodeURIComponent(e),a).pipe(b(h=>(this.loggerService.logDebug(n,"-gen access--"+c),h===t))))))}millisToMinutesAndSeconds(e){let t=Math.floor(e/6e4),r=(e%6e4/1e3).toFixed(0);return t+":"+(+r<10?"0":"")+r}calculateNowWithOffset(e){return new Date(new Date().toUTCString()).valueOf()+e*1e3}};i.refreshTokenNoncePlaceholder="--RefreshToken--",i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Bs={isAuthenticated:!1,allConfigsAuthenticated:[]},Y=(()=>{let i=class i{constructor(){this.storagePersistenceService=l(P),this.loggerService=l(_),this.publicEventsService=l(fe),this.tokenValidationService=l(mt),this.authenticatedInternal$=new Ze(Bs)}get authenticated$(){return this.authenticatedInternal$.asObservable().pipe(Vt())}setAuthenticatedAndFireEvent(e){let t=this.composeAuthenticatedResult(e);this.authenticatedInternal$.next(t)}setUnauthenticatedAndFireEvent(e,t){this.storagePersistenceService.resetAuthStateInStorage(e);let r=this.composeUnAuthenticatedResult(t);this.authenticatedInternal$.next(r)}updateAndPublishAuthState(e){this.publicEventsService.fireEvent(F.NewAuthenticationResult,e)}setAuthorizationData(e,t,r,n){this.loggerService.logDebug(r,`storing the accessToken '${e}'`),this.storagePersistenceService.write("authzData",e,r),this.persistAccessTokenExpirationTime(t,r),this.setAuthenticatedAndFireEvent(n)}getAccessToken(e){if(!e||!this.isAuthenticated(e))return"";let t=this.storagePersistenceService.getAccessToken(e);return this.decodeURIComponentSafely(t)}getIdToken(e){if(!e||!this.isAuthenticated(e))return"";let t=this.storagePersistenceService.getIdToken(e);return this.decodeURIComponentSafely(t)}getRefreshToken(e){if(!e||!this.isAuthenticated(e))return"";let t=this.storagePersistenceService.getRefreshToken(e);return this.decodeURIComponentSafely(t)}getAuthenticationResult(e){return!e||!this.isAuthenticated(e)?null:this.storagePersistenceService.getAuthenticationResult(e)}areAuthStorageTokensValid(e){return!e||!this.isAuthenticated(e)?!1:this.hasIdTokenExpiredAndRenewCheckIsEnabled(e)?(this.loggerService.logDebug(e,"persisted idToken is expired"),!1):this.hasAccessTokenExpiredIfExpiryExists(e)?(this.loggerService.logDebug(e,"persisted accessToken is expired"),!1):(this.loggerService.logDebug(e,"persisted idToken and accessToken are valid"),!0)}hasIdTokenExpiredAndRenewCheckIsEnabled(e){let{renewTimeBeforeTokenExpiresInSeconds:t,triggerRefreshWhenIdTokenExpired:r,disableIdTokenValidation:n}=e;if(!r||n)return!1;let a=this.storagePersistenceService.getIdToken(e),c=this.tokenValidationService.hasIdTokenExpired(a,e,t);return c&&this.publicEventsService.fireEvent(F.IdTokenExpired,c),c}hasAccessTokenExpiredIfExpiryExists(e){let{renewTimeBeforeTokenExpiresInSeconds:t}=e,r=this.storagePersistenceService.read("access_token_expires_at",e),a=!this.tokenValidationService.validateAccessTokenNotExpired(r,e,t);return a&&this.publicEventsService.fireEvent(F.TokenExpired,a),a}isAuthenticated(e){if(!e)return v(()=>new Error("Please provide a configuration before setting up the module")),!1;let t=!!this.storagePersistenceService.getAccessToken(e),r=!!this.storagePersistenceService.getIdToken(e);return t&&r}decodeURIComponentSafely(e){return e?decodeURIComponent(e):""}persistAccessTokenExpirationTime(e,t){if(e?.expires_in){let r=new Date(new Date().toUTCString()).valueOf()+e.expires_in*1e3;this.storagePersistenceService.write("access_token_expires_at",r,t)}}composeAuthenticatedResult(e){if(e.length===1){let{configId:t}=e[0];return{isAuthenticated:!0,allConfigsAuthenticated:[{configId:t??"",isAuthenticated:!0}]}}return this.checkAllConfigsIfTheyAreAuthenticated(e)}composeUnAuthenticatedResult(e){if(e.length===1){let{configId:t}=e[0];return{isAuthenticated:!1,allConfigsAuthenticated:[{configId:t??"",isAuthenticated:!1}]}}return this.checkAllConfigsIfTheyAreAuthenticated(e)}checkAllConfigsIfTheyAreAuthenticated(e){let t=e.map(n=>({configId:n.configId??"",isAuthenticated:this.isAuthenticated(n)})),r=t.every(n=>n.isAuthenticated);return{allConfigsAuthenticated:t,isAuthenticated:r}}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),ii="redirect",zs=(()=>{let i=class i{constructor(){this.storageService=l(P),this.router=l(ke)}checkSavedRedirectRouteAndNavigate(e){if(!e)return;let t=this.getStoredRedirectRoute(e);t!=null&&(this.deleteStoredRedirectRoute(e),this.router.navigateByUrl(t))}saveRedirectRoute(e,t){e&&this.storageService.write(ii,t,e)}getStoredRedirectRoute(e){return this.storageService.read(ii,e)}deleteStoredRedirectRoute(e){this.storageService.remove(ii,e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),se=(()=>{let i=class i{isCurrentFlowCodeFlow(e){return this.currentFlowIs("code",e)}isCurrentFlowAnyImplicitFlow(e){return this.isCurrentFlowImplicitFlowWithAccessToken(e)||this.isCurrentFlowImplicitFlowWithoutAccessToken(e)}isCurrentFlowCodeFlowWithRefreshTokens(e){if(!e)return!1;let{useRefreshToken:t}=e;return this.isCurrentFlowCodeFlow(e)&&!!t}isCurrentFlowImplicitFlowWithAccessToken(e){return this.currentFlowIs("id_token token",e)}currentFlowIs(e,t){let{responseType:r}=t;return Array.isArray(e)?e.some(n=>r===n):r===e}isCurrentFlowImplicitFlowWithoutAccessToken(e){return this.currentFlowIs("id_token",e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),js=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.cryptoService=l(oi)}createRandom(e,t){if(e<=0)return"";e>0&&e<7&&(this.loggerService.logWarning(t,`RandomService called with ${e} but 7 chars is the minimum, returning 10 chars`),e=10);let r=e-6,n=new Uint8Array(Math.floor(r/2)),a=this.cryptoService.getCrypto();return a&&a.getRandomValues(n),Array.from(n,this.toHex).join("")+this.randomString(7)}toHex(e){return("0"+e.toString(16)).substr(-2)}randomString(e){let t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=new Uint32Array(e),a=this.cryptoService.getCrypto();if(a){a.getRandomValues(n);for(let c=0;c<e;c++)t+=r[n[c]%r.length]}return t}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),U=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.storagePersistenceService=l(P),this.randomService=l(js)}createNonce(e){let t=this.randomService.createRandom(40,e);return this.loggerService.logDebug(e,"Nonce created. nonce:"+t),this.setNonce(t,e),t}setNonce(e,t){this.storagePersistenceService.write("authNonce",e,t)}getAuthStateControl(e){return e?this.storagePersistenceService.read("authStateControl",e):""}setAuthStateControl(e,t){return t?this.storagePersistenceService.write("authStateControl",e,t):!1}getExistingOrCreateAuthStateControl(e){let t=this.storagePersistenceService.read("authStateControl",e);return t||(t=this.randomService.createRandom(40,e),this.storagePersistenceService.write("authStateControl",t,e)),t}setSessionState(e,t){this.storagePersistenceService.write("session_state",e,t)}resetStorageFlowData(e){this.storagePersistenceService.resetStorageFlowData(e)}getCodeVerifier(e){return this.storagePersistenceService.read("codeVerifier",e)}createCodeVerifier(e){let t=this.randomService.createRandom(67,e);return this.storagePersistenceService.write("codeVerifier",t,e),t}isCodeFlowInProgress(e){return!!this.storagePersistenceService.read("storageCodeFlowInProgress",e)}setCodeFlowInProgress(e){this.storagePersistenceService.write("storageCodeFlowInProgress",!0,e)}resetCodeFlowInProgress(e){this.storagePersistenceService.write("storageCodeFlowInProgress",!1,e)}isSilentRenewRunning(e){let{configId:t,silentRenewTimeoutInSeconds:r}=e,n=this.getSilentRenewRunningStorageEntry(e);if(!n||n.state==="not-running")return!1;let a=(r??0)*1e3,c=Date.parse(n.dateOfLaunchedProcessUtc),h=Date.parse(new Date().toISOString());return Math.abs(h-c)>a?(this.loggerService.logDebug(e,"silent renew process is probably stuck, state will be reset.",t),this.resetSilentRenewRunning(e),!1):n.state==="running"}setSilentRenewRunning(e){let t={state:"running",dateOfLaunchedProcessUtc:new Date().toISOString()};this.storagePersistenceService.write("storageSilentRenewRunning",JSON.stringify(t),e)}resetSilentRenewRunning(e){e&&this.storagePersistenceService.write("storageSilentRenewRunning","",e)}getSilentRenewRunningStorageEntry(e){let t=this.storagePersistenceService.read("storageSilentRenewRunning",e);return t?JSON.parse(t):{dateOfLaunchedProcessUtc:"",state:"not-running"}}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),si=class{encodeKey(i){return encodeURIComponent(i)}encodeValue(i){return encodeURIComponent(i)}decodeKey(i){return decodeURIComponent(i)}decodeValue(i){return decodeURIComponent(i)}},$s=["code","state","token","id_token"],Ks="auth0.com",G=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.flowsDataService=l(U),this.flowHelper=l(se),this.storagePersistenceService=l(P),this.jwtWindowCryptoService=l(Mr)}getUrlParameter(e,t){if(!e||!t)return"";t=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");let n=new RegExp("[\\?&#]"+t+"=([^&#]*)").exec(e);return n===null?"":decodeURIComponent(n[1])}getUrlWithoutQueryParameters(e){let t=new URL(e.toString()),r=[];for(let n of t.searchParams.keys())r.push(n);return r.forEach(n=>{t.searchParams.delete(n)}),t}queryParametersExist(e,t){let r=!0;return e.forEach((n,a)=>{t.has(a)||(r=!1)}),r}isCallbackFromSts(e,t){if(t&&t.checkRedirectUrlWhenCheckingIfIsCallback){let r=new URL(e),n=this.getRedirectUrl(t);if(!n)return this.loggerService.logError(t,"UrlService.isCallbackFromSts: could not get redirectUrl from config, was: ",n),!1;let a=new URL(n),c=this.getUrlWithoutQueryParameters(a).toString(),h=this.getUrlWithoutQueryParameters(r).toString(),d=this.queryParametersExist(a.searchParams,r.searchParams);if(c!==h||!d)return this.loggerService.logDebug(t,"UrlService.isCallbackFromSts: configured redirectUrl does not match with the current url"),!1}return $s.some(r=>!!this.getUrlParameter(e,r))}getRefreshSessionSilentRenewUrl(e,t){return this.flowHelper.isCurrentFlowCodeFlow(e)?this.createUrlCodeFlowWithSilentRenew(e,t):p(this.createUrlImplicitFlowWithSilentRenew(e,t))}getAuthorizeParUrl(e,t){let r=this.storagePersistenceService.read("authWellKnownEndPoints",t);if(!r)return this.loggerService.logError(t,"authWellKnownEndpoints is undefined"),null;let n=r.authorizationEndpoint;if(!n)return this.loggerService.logError(t,`Can not create an authorize URL when authorizationEndpoint is '${n}'`),null;let{clientId:a}=t;if(!a)return this.loggerService.logError(t,"getAuthorizeParUrl could not add clientId because it was: ",a),null;let c=n.split("?"),h=c[0],d=c[1],u=this.createHttpParams(d);return u=u.set("request_uri",e),u=u.append("client_id",a),`${h}?${u}`}getAuthorizeUrl(e,t){return e?this.flowHelper.isCurrentFlowCodeFlow(e)?this.createUrlCodeFlowAuthorize(e,t):p(this.createUrlImplicitFlowAuthorize(e,t)||""):p(null)}getEndSessionEndpoint(e){let r=this.storagePersistenceService.read("authWellKnownEndPoints",e)?.endSessionEndpoint;if(!r)return{url:"",existingParams:""};let n=r.split("?"),a=n[0],c=n[1]??"";return{url:a,existingParams:c}}getEndSessionUrl(e,t){if(!e)return null;let r=this.storagePersistenceService.getIdToken(e),{customParamsEndSessionRequest:n}=e,a=y(y({},n),t);return this.createEndSessionUrl(r,e,a)}createRevocationEndpointBodyAccessToken(e,t){let r=this.getClientId(t);if(!r)return null;let n=this.createHttpParams();return n=n.set("client_id",r),n=n.set("token",e),n=n.set("token_type_hint","access_token"),n.toString()}createRevocationEndpointBodyRefreshToken(e,t){let r=this.getClientId(t);if(!r)return null;let n=this.createHttpParams();return n=n.set("client_id",r),n=n.set("token",e),n=n.set("token_type_hint","refresh_token"),n.toString()}getRevocationEndpointUrl(e){let r=this.storagePersistenceService.read("authWellKnownEndPoints",e)?.revocationEndpoint;return r?r.split("?")[0]:null}createBodyForCodeFlowCodeRequest(e,t,r){let n=this.getClientId(t);if(!n)return null;let a=this.createHttpParams();if(a=a.set("grant_type","authorization_code"),a=a.set("client_id",n),!t.disablePkce){let d=this.flowsDataService.getCodeVerifier(t);if(!d)return this.loggerService.logError(t,"CodeVerifier is not set ",d),null;a=a.set("code_verifier",d)}a=a.set("code",e),r&&(a=this.appendCustomParams(y({},r),a));let c=this.getSilentRenewUrl(t);if(this.flowsDataService.isSilentRenewRunning(t)&&c)return a=a.set("redirect_uri",c),a.toString();let h=this.getRedirectUrl(t);return h?(a=a.set("redirect_uri",h),a.toString()):null}createBodyForCodeFlowRefreshTokensRequest(e,t,r){let n=this.getClientId(t);if(!n)return null;let a=this.createHttpParams();return a=a.set("grant_type","refresh_token"),a=a.set("client_id",n),a=a.set("refresh_token",e),r&&(a=this.appendCustomParams(y({},r),a)),a.toString()}createBodyForParCodeFlowRequest(e,t){let r=this.getRedirectUrl(e,t);if(!r)return p(null);let n=this.flowsDataService.getExistingOrCreateAuthStateControl(e),a=this.flowsDataService.createNonce(e);this.loggerService.logDebug(e,"Authorize created. adding myautostate: "+n);let c=this.flowsDataService.createCodeVerifier(e);return this.jwtWindowCryptoService.generateCodeChallenge(c).pipe(b(h=>{let{clientId:d,responseType:u,scope:g,hdParam:S,customParamsAuthRequest:w}=e,m=this.createHttpParams("");return m=m.set("client_id",d??""),m=m.append("redirect_uri",r),m=m.append("response_type",u??""),m=m.append("scope",g??""),m=m.append("nonce",a),m=m.append("state",n),m=m.append("code_challenge",h),m=m.append("code_challenge_method","S256"),S&&(m=m.append("hd",S)),w&&(m=this.appendCustomParams(y({},w),m)),t?.customParams&&(m=this.appendCustomParams(y({},t.customParams),m)),m.toString()}))}getPostLogoutRedirectUrl(e){let{postLogoutRedirectUri:t}=e;return t||(this.loggerService.logError(e,"could not get postLogoutRedirectUri, was: ",t),null)}createEndSessionUrl(e,t,r){if(this.isAuth0Endpoint(t))return this.composeAuth0Endpoint(t);let{url:n,existingParams:a}=this.getEndSessionEndpoint(t);if(!n)return null;let c=this.createHttpParams(a);e&&(c=c.set("id_token_hint",e));let h=this.getPostLogoutRedirectUrl(t);return h&&(c=c.append("post_logout_redirect_uri",h)),r&&(c=this.appendCustomParams(y({},r),c)),`${n}?${c}`}createAuthorizeUrl(e,t,r,n,a,c,h){let u=this.storagePersistenceService.read("authWellKnownEndPoints",a)?.authorizationEndpoint;if(!u)return this.loggerService.logError(a,`Can not create an authorize URL when authorizationEndpoint is '${u}'`),"";let{clientId:g,responseType:S,scope:w,hdParam:m,customParamsAuthRequest:X}=a;if(!g)return this.loggerService.logError(a,"createAuthorizeUrl could not add clientId because it was: ",g),"";if(!S)return this.loggerService.logError(a,"createAuthorizeUrl could not add responseType because it was: ",S),"";if(!w)return this.loggerService.logError(a,"createAuthorizeUrl could not add scope because it was: ",w),"";let z=u.split("?"),oe=z[0],Te=z[1],R=this.createHttpParams(Te);R=R.set("client_id",g),R=R.append("redirect_uri",t),R=R.append("response_type",S),R=R.append("scope",w),R=R.append("nonce",r),R=R.append("state",n),this.flowHelper.isCurrentFlowCodeFlow(a)&&(R=R.append("code_challenge",e),R=R.append("code_challenge_method","S256"));let Ri=y(y({},X),h);return Object.keys(Ri).length>0&&(R=this.appendCustomParams(y({},Ri),R)),c&&(R=this.overWriteParam(R,"prompt",c)),m&&(R=R.append("hd",m)),`${oe}?${R}`}createUrlImplicitFlowWithSilentRenew(e,t){let r=this.flowsDataService.getExistingOrCreateAuthStateControl(e),n=this.flowsDataService.createNonce(e),a=this.getSilentRenewUrl(e);return a?(this.loggerService.logDebug(e,"RefreshSession created. adding myautostate: ",r),this.storagePersistenceService.read("authWellKnownEndPoints",e)?this.createAuthorizeUrl("",a,n,r,e,"none",t):(this.loggerService.logError(e,"authWellKnownEndpoints is undefined"),null)):null}createUrlCodeFlowWithSilentRenew(e,t){let r=this.flowsDataService.getExistingOrCreateAuthStateControl(e),n=this.flowsDataService.createNonce(e);this.loggerService.logDebug(e,"RefreshSession created. adding myautostate: "+r);let a=this.flowsDataService.createCodeVerifier(e);return this.jwtWindowCryptoService.generateCodeChallenge(a).pipe(b(c=>{let h=this.getSilentRenewUrl(e);return h?this.storagePersistenceService.read("authWellKnownEndPoints",e)?this.createAuthorizeUrl(c,h,n,r,e,"none",t):(this.loggerService.logWarning(e,"authWellKnownEndpoints is undefined"),""):""}))}createUrlImplicitFlowAuthorize(e,t){let r=this.flowsDataService.getExistingOrCreateAuthStateControl(e),n=this.flowsDataService.createNonce(e);this.loggerService.logDebug(e,"Authorize created. adding myautostate: "+r);let a=this.getRedirectUrl(e,t);if(!a)return null;if(this.storagePersistenceService.read("authWellKnownEndPoints",e)){let{customParams:h}=t||{};return this.createAuthorizeUrl("",a,n,r,e,"",h)}return this.loggerService.logError(e,"authWellKnownEndpoints is undefined"),null}createUrlCodeFlowAuthorize(e,t){let r=this.flowsDataService.getExistingOrCreateAuthStateControl(e),n=this.flowsDataService.createNonce(e);this.loggerService.logDebug(e,"Authorize created. adding myautostate: "+r);let a=this.getRedirectUrl(e,t);return a?this.getCodeChallenge(e).pipe(b(c=>{if(this.storagePersistenceService.read("authWellKnownEndPoints",e)){let{customParams:d}=t||{};return this.createAuthorizeUrl(c,a,n,r,e,"",d)}return this.loggerService.logError(e,"authWellKnownEndpoints is undefined"),""})):p(null)}getCodeChallenge(e){if(e.disablePkce)return p("");let t=this.flowsDataService.createCodeVerifier(e);return this.jwtWindowCryptoService.generateCodeChallenge(t)}getRedirectUrl(e,t){let{redirectUrl:r}=e;return t?.redirectUrl&&(r=t.redirectUrl),r||(this.loggerService.logError(e,"could not get redirectUrl, was: ",r),null)}getSilentRenewUrl(e){let{silentRenewUrl:t}=e;return t||(this.loggerService.logError(e,"could not get silentRenewUrl, was: ",t),null)}getClientId(e){let{clientId:t}=e;return t||(this.loggerService.logError(e,"could not get clientId, was: ",t),null)}appendCustomParams(e,t){for(let[r,n]of Object.entries(y({},e)))t=t.append(r,n.toString());return t}overWriteParam(e,t,r){return e.set(t,r)}createHttpParams(e){return e=e??"",new at({fromString:e,encoder:new si})}isAuth0Endpoint(e){let{authority:t,useCustomAuth0Domain:r}=e;return t?t.endsWith(Ks)||!!r:!1}composeAuth0Endpoint(e){let{authority:t,clientId:r}=e,n=this.getPostLogoutRedirectUrl(e);return`${t}/v2/logout?client_id=${r}&returnTo=${n}`}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Ys=(()=>{let i=class i{constructor(){this.http=l(lt)}get(e,t){return this.http.get(e,t)}post(e,t,r){return this.http.post(e,t,r)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Xs="ngsw-bypass",pe=(()=>{let i=class i{constructor(){this.httpClient=l(Ys)}get(e,t,r){let n=this.prepareHeaders(r),a=this.prepareParams(t);return this.httpClient.get(e,{headers:n,params:a})}post(e,t,r,n){let a=n||this.prepareHeaders(),c=this.prepareParams(r);return this.httpClient.post(e??"",t,{headers:a,params:c})}prepareHeaders(e){let t=new be;return t=t.set("Accept","application/json"),e&&(t=t.set("Authorization","Bearer "+decodeURIComponent(e))),t}prepareParams(e){let t=new at,{ngswBypass:r}=e;return r&&(t=t.set(Xs,"")),t}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Fr=s=>!!s&&s instanceof Xi&&(s.error instanceof ProgressEvent&&s.error.type==="error"||s.status===0&&!!s.error),qs=(()=>{let i=class i{constructor(){this.urlService=l(G),this.loggerService=l(_),this.tokenValidationService=l(mt),this.flowsDataService=l(U),this.storagePersistenceService=l(P),this.dataService=l(pe)}codeFlowCallback(e,t){let r=this.urlService.getUrlParameter(e,"code"),n=this.urlService.getUrlParameter(e,"state"),a=this.urlService.getUrlParameter(e,"session_state");return n?r?(this.loggerService.logDebug(t,"running validation for callback",e),p({code:r,refreshToken:"",state:n,sessionState:a,authResult:null,isRenewProcess:!1,jwtKeys:null,validationResult:null,existingIdToken:null})):(this.loggerService.logDebug(t,"no code in url"),v(()=>new Error("no code in url"))):(this.loggerService.logDebug(t,"no state in url"),v(()=>new Error("no state in url")))}codeFlowCodeRequest(e,t){let r=this.flowsDataService.getAuthStateControl(t);if(!this.tokenValidationService.validateStateFromHashCallback(e.state,r,t))return v(()=>new Error("codeFlowCodeRequest incorrect state"));let c=this.storagePersistenceService.read("authWellKnownEndPoints",t)?.tokenEndpoint;if(!c)return v(()=>new Error("Token Endpoint not defined"));let h=new be;h=h.set("Content-Type","application/x-www-form-urlencoded");let d=this.urlService.createBodyForCodeFlowCodeRequest(e.code,t,t?.customParamsCodeRequest);return this.dataService.post(c,d,t,h).pipe(I(u=>{if(u){let g=ae(y({},u),{state:e.state,session_state:e.sessionState});e.authResult=g}return p(e)}),tt(u=>this.handleRefreshRetry(u,t)),A(u=>{let{authority:g}=t,S=`OidcService code request ${g}`;return this.loggerService.logError(t,S,u),v(()=>new Error(S))}))}handleRefreshRetry(e,t){return e.pipe(ce(r=>{if(Fr(r)){let{authority:n,refreshTokenRetryInSeconds:a}=t,c=`OidcService code request ${n} - no internet connection`;return this.loggerService.logWarning(t,c,r),et((a??0)*1e3)}return v(()=>r)}))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),D=(function(s){return s.NotSet="NotSet",s.StatesDoNotMatch="StatesDoNotMatch",s.SignatureFailed="SignatureFailed",s.IncorrectNonce="IncorrectNonce",s.RequiredPropertyMissing="RequiredPropertyMissing",s.MaxOffsetExpired="MaxOffsetExpired",s.IssDoesNotMatchIssuer="IssDoesNotMatchIssuer",s.NoAuthWellKnownEndPoints="NoAuthWellKnownEndPoints",s.IncorrectAud="IncorrectAud",s.IncorrectIdTokenClaimsAfterRefresh="IncorrectIdTokenClaimsAfterRefresh",s.IncorrectAzp="IncorrectAzp",s.TokenExpired="TokenExpired",s.IncorrectAtHash="IncorrectAtHash",s.Ok="Ok",s.LoginRequired="LoginRequired",s.SecureTokenServerError="SecureTokenServerError",s})(D||{}),Gs={userData:null,allUserData:[]},Ce=(()=>{let i=class i{constructor(){this.userDataInternal$=new Ze(Gs),this.loggerService=l(_),this.tokenHelperService=l(vt),this.flowHelper=l(se),this.oidcDataService=l(pe),this.storagePersistenceService=l(P),this.eventService=l(fe)}get userData$(){return this.userDataInternal$.asObservable()}getAndPersistUserDataInStore(e,t,r=!1,n,a){n=n||this.storagePersistenceService.getIdToken(e),a=a||this.tokenHelperService.getPayloadFromToken(n,!1,e);let c=this.getUserDataFromStore(e),h=!!c,d=this.flowHelper.isCurrentFlowImplicitFlowWithAccessToken(e),u=this.flowHelper.isCurrentFlowCodeFlow(e),g=this.storagePersistenceService.getAccessToken(e);if(!(d||u))return this.loggerService.logDebug(e,`authCallback idToken flow with accessToken ${g}`),this.setUserDataToStore(a,e,t),p(a);let{renewUserInfoAfterTokenRenew:S}=e;return!r||S||!h?this.getUserDataOidcFlowAndSave(a.sub,e,t).pipe(I(w=>(this.loggerService.logDebug(e,"Received user data: ",w),w?(this.loggerService.logDebug(e,"accessToken: ",g),p(w)):v(()=>new Error("Received no user data, request failed"))))):p(c)}getUserDataFromStore(e){return e?this.storagePersistenceService.read("userData",e)||null:v(()=>new Error("Please provide a configuration before setting up the module"))}publishUserDataIfExists(e,t){let r=this.getUserDataFromStore(e);r&&this.fireUserDataEvent(e,t,r)}setUserDataToStore(e,t,r){this.storagePersistenceService.write("userData",e,t),this.fireUserDataEvent(t,r,e)}resetUserDataInStore(e,t){this.storagePersistenceService.remove("userData",e),this.fireUserDataEvent(e,t,null)}getUserDataOidcFlowAndSave(e,t,r){return this.getIdentityUserData(t).pipe(b(n=>this.validateUserDataSubIdToken(t,e,n?.sub)?(this.setUserDataToStore(n,t,r),n):(this.loggerService.logWarning(t,"User data sub does not match sub in id_token, resetting"),this.resetUserDataInStore(t,r),null)))}getIdentityUserData(e){let t=this.storagePersistenceService.getAccessToken(e),r=this.storagePersistenceService.read("authWellKnownEndPoints",e);if(!r)return this.loggerService.logWarning(e,"init check session: authWellKnownEndpoints is undefined"),v(()=>new Error("authWellKnownEndpoints is undefined"));let n=r.userInfoEndpoint;return n?this.oidcDataService.get(n,e,t).pipe(Se(2)):(this.loggerService.logError(e,"init check session: authWellKnownEndpoints.userinfo_endpoint is undefined; set auto_userinfo = false in config"),v(()=>new Error("authWellKnownEndpoints.userinfo_endpoint is undefined")))}validateUserDataSubIdToken(e,t,r){return!t||!r?!1:t.toString()!==r.toString()?(this.loggerService.logDebug(e,"validateUserDataSubIdToken failed",t,r),!1):!0}fireUserDataEvent(e,t,r){let n=this.composeSingleOrMultipleUserDataObject(e,t,r);this.userDataInternal$.next(n);let{configId:a}=e;this.eventService.fireEvent(F.UserDataChanged,{configId:a,userData:r})}composeSingleOrMultipleUserDataObject(e,t,r){if(!(t.length>1)){let{configId:c}=e;return this.composeSingleUserDataResult(c??"",r)}return{userData:null,allUserData:t.map(c=>{let h=e.configId??"",d=c.configId??"";if(this.currentConfigIsToUpdate(h,c))return{configId:d,userData:r};let u=this.storagePersistenceService.read("userData",c)||null;return{configId:d,userData:u}})}}composeSingleUserDataResult(e,t){return{userData:t,allUserData:[{configId:e,userData:t}]}}currentConfigIsToUpdate(e,t){return t.configId===e}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),ne=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.userService=l(Ce),this.flowsDataService=l(U),this.authStateService=l(Y)}resetAuthorizationData(e,t){e&&(this.userService.resetUserDataInStore(e,t),this.flowsDataService.resetStorageFlowData(e),this.authStateService.setUnauthenticatedAndFireEvent(e,t),this.loggerService.logDebug(e,"Local Login information cleaned up and event fired"))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Zs=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.storagePersistenceService=l(P),this.dataService=l(pe)}getSigningKeys(e){let r=this.storagePersistenceService.read("authWellKnownEndPoints",e)?.jwksUri;if(!r){let n=`getSigningKeys: authWellKnownEndpoints.jwksUri is: '${r}'`;return this.loggerService.logWarning(e,n),v(()=>new Error(n))}return this.loggerService.logDebug(e,"Getting signinkeys from ",r),this.dataService.get(r,e).pipe(Se(2),A(n=>this.handleErrorGetSigningKeys(n,e)))}handleErrorGetSigningKeys(e,t){let r="";if(e instanceof Yi){let n=e.body||{},a=JSON.stringify(n),{status:c,statusText:h}=e;r=`${c||""} - ${h||""} ${a||""}`}else{let{message:n}=e;r=n||`${e}`}return this.loggerService.logError(t,r),v(()=>new Error(r))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Er="jwtKeys",Js=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.authStateService=l(Y),this.flowsDataService=l(U),this.signInKeyDataService=l(Zs),this.storagePersistenceService=l(P),this.resetAuthDataService=l(ne),this.document=l(C)}callbackHistoryAndResetJwtKeys(e,t,r){let n=y({},e.authResult);if(!this.responseHasIdToken(e)){let a=this.storagePersistenceService.getIdToken(t);n=ae(y({},n),{id_token:a})}if(this.storagePersistenceService.write("authnResult",n,t),t.allowUnsafeReuseRefreshToken&&e.authResult?.refresh_token&&this.storagePersistenceService.write("reusable_refresh_token",e.authResult.refresh_token,t),this.historyCleanUpTurnedOn(t)&&!e.isRenewProcess?this.resetBrowserHistory():this.loggerService.logDebug(t,"history clean up inactive"),e.authResult?.error){let a=`AuthCallback AuthResult came with error: ${e.authResult.error}`;return this.loggerService.logDebug(t,a),this.resetAuthDataService.resetAuthorizationData(t,r),this.flowsDataService.setNonce("",t),this.handleResultErrorFromCallback(e.authResult,e.isRenewProcess,t.configId),v(()=>new Error(a))}return this.loggerService.logDebug(t,`AuthResult '${JSON.stringify(e.authResult,null,2)}'.
      AuthCallback created, begin token validation`),this.signInKeyDataService.getSigningKeys(t).pipe(x(a=>this.storeSigningKeys(a,t)),A(a=>{let c=this.readSigningKeys(t);return c?(this.loggerService.logWarning(t,"Failed to retrieve signing keys, fallback to stored keys"),p(c)):v(()=>new Error(a))}),I(a=>{if(a)return e.jwtKeys=a,p(e);let c="Failed to retrieve signing key";return this.loggerService.logWarning(t,c),v(()=>new Error(c))}),A(a=>{let c=`Failed to retrieve signing key with error: ${a}`;return this.loggerService.logWarning(t,c),v(()=>new Error(c))}))}responseHasIdToken(e){return!!e?.authResult?.id_token}handleResultErrorFromCallback(e,t,r){let n=D.SecureTokenServerError;e&&typeof e=="object"&&"error"in e&&e.error==="login_required"&&(n=D.LoginRequired),this.authStateService.updateAndPublishAuthState({isAuthenticated:!1,validationResult:n,isRenewProcess:t,configId:r})}historyCleanUpTurnedOn(e){let{historyCleanupOff:t}=e;return!t}resetBrowserHistory(){this.document.defaultView?.history.replaceState({},this.document.title,this.document.defaultView.location.origin+this.document.defaultView.location.pathname)}storeSigningKeys(e,t){this.storagePersistenceService.write(Er,e,t)}readSigningKeys(e){return this.storagePersistenceService.read(Er,e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Qs=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.resetAuthDataService=l(ne),this.flowsDataService=l(U),this.document=l(C)}implicitFlowCallback(e,t,r){let n=this.flowsDataService.isSilentRenewRunning(e);this.loggerService.logDebug(e,"BEGIN callback, no auth data"),n||this.resetAuthDataService.resetAuthorizationData(e,t),r=r||this.document.location.hash.substring(1);let c={code:"",refreshToken:"",state:"",sessionState:null,authResult:r.split("&").reduce((h,d)=>{let u=d.split("=");return h[u.shift()]=u.join("="),h},{}),isRenewProcess:n,jwtKeys:null,validationResult:null,existingIdToken:null};return p(c)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),en=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.authStateService=l(Y),this.flowsDataService=l(U)}refreshSessionWithRefreshTokens(e){let t=this.flowsDataService.getExistingOrCreateAuthStateControl(e);this.loggerService.logDebug(e,"RefreshSession created. Adding myautostate: "+t);let r=this.authStateService.getRefreshToken(e),n=this.authStateService.getIdToken(e);if(r){let a={code:"",refreshToken:r,state:t,sessionState:null,authResult:null,isRenewProcess:!0,jwtKeys:null,validationResult:null,existingIdToken:n};return this.loggerService.logDebug(e,"found refresh code, obtaining new credentials with refresh code"),this.flowsDataService.setNonce(mt.refreshTokenNoncePlaceholder,e),p(a)}else{let a="no refresh token found, please login";return this.loggerService.logError(e,a),v(()=>new Error(a))}}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),tn=(()=>{let i=class i{constructor(){this.urlService=l(G),this.loggerService=l(_),this.dataService=l(pe),this.storagePersistenceService=l(P)}refreshTokensRequestTokens(e,t,r){let n=new be;n=n.set("Content-Type","application/x-www-form-urlencoded");let c=this.storagePersistenceService.read("authWellKnownEndPoints",t)?.tokenEndpoint;if(!c)return v(()=>new Error("Token Endpoint not defined"));let h=this.urlService.createBodyForCodeFlowRefreshTokensRequest(e.refreshToken,t,r);return this.dataService.post(c,h,t,n).pipe(I(d=>(this.loggerService.logDebug(t,`token refresh response: ${d}`),d&&(d.state=e.state),e.authResult=d,p(e))),tt(d=>this.handleRefreshRetry(d,t)),A(d=>{let{authority:u}=t,g=`OidcService code request ${u}`;return this.loggerService.logError(t,g,d),v(()=>new Error(g))}))}handleRefreshRetry(e,t){return e.pipe(ce(r=>{if(Fr(r)){let{authority:n,refreshTokenRetryInSeconds:a}=t,c=`OidcService code request ${n} - no internet connection`;return this.loggerService.logWarning(t,c,r),et((a??0)*1e3)}return v(()=>r)}))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),rn=(()=>{let i=class i{isStringEqualOrNonOrderedArrayEqual(e,t){return this.isNullOrUndefined(e)||this.isNullOrUndefined(t)||this.oneValueIsStringAndTheOtherIsArray(e,t)?!1:this.bothValuesAreStrings(e,t)?e===t:this.arraysHaveEqualContent(e,t)}areEqual(e,t){if(!e||!t)return!1;if(this.bothValuesAreArrays(e,t))return this.arraysStrictEqual(e,t);if(this.bothValuesAreStrings(e,t))return e===t;if(this.bothValuesAreObjects(e,t))return JSON.stringify(e).toLowerCase()===JSON.stringify(t).toLowerCase();if(this.oneValueIsStringAndTheOtherIsArray(e,t)){if(Array.isArray(e)&&this.valueIsString(t))return e[0]===t;if(Array.isArray(t)&&this.valueIsString(e))return t[0]===e}return e===t}oneValueIsStringAndTheOtherIsArray(e,t){return Array.isArray(e)&&this.valueIsString(t)||Array.isArray(t)&&this.valueIsString(e)}bothValuesAreObjects(e,t){return this.valueIsObject(e)&&this.valueIsObject(t)}bothValuesAreStrings(e,t){return this.valueIsString(e)&&this.valueIsString(t)}bothValuesAreArrays(e,t){return Array.isArray(e)&&Array.isArray(t)}valueIsString(e){return typeof e=="string"||e instanceof String}valueIsObject(e){return typeof e=="object"}arraysStrictEqual(e,t){if(e.length!==t.length)return!1;for(let r=e.length;r--;)if(e[r]!==t[r])return!1;return!0}arraysHaveEqualContent(e,t){return e.length!==t.length?!1:e.some(r=>t.includes(r))}isNullOrUndefined(e){return e==null}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),gt=class{constructor(i="",o="",e=!1,t={at_hash:""},r=D.NotSet){this.accessToken=i,this.idToken=o,this.authResponseIsValid=e,this.decodedIdToken=t,this.state=r}},sn=(()=>{let i=class i{constructor(){this.storagePersistenceService=l(P),this.tokenValidationService=l(mt),this.tokenHelperService=l(vt),this.loggerService=l(_),this.equalityService=l(rn),this.flowHelper=l(se)}getValidatedStateResult(e,t){let r=!!e.authResult?.error;return!!!e||r?p(new gt("","",!1,{})):this.validateState(e,t)}validateState(e,t){let r=new gt,n=this.storagePersistenceService.read("authStateControl",t);if(!this.tokenValidationService.validateStateFromHashCallback(e.authResult?.state,n,t))return this.loggerService.logWarning(t,"authCallback incorrect state"),r.state=D.StatesDoNotMatch,this.handleUnsuccessfulValidation(t),p(r);let a=this.flowHelper.isCurrentFlowImplicitFlowWithAccessToken(t),c=this.flowHelper.isCurrentFlowCodeFlow(t);if((a||c)&&(r.accessToken=e.authResult?.access_token??""),t.disableIdTokenValidation)return r.state=D.Ok,r.authResponseIsValid=!0,p(r);let d=e.isRenewProcess&&!!e.refreshToken,u=!!e.authResult?.id_token;if(d&&!u)return r.state=D.Ok,r.authResponseIsValid=!0,p(r);if(u){let{clientId:g,issValidationOff:S,maxIdTokenIatOffsetAllowedInSeconds:w,disableIatOffsetValidation:m,ignoreNonceAfterRefresh:X,renewTimeBeforeTokenExpiresInSeconds:z}=t;return r.idToken=e.authResult?.id_token??"",r.decodedIdToken=this.tokenHelperService.getPayloadFromToken(r.idToken,!1,t),this.tokenValidationService.validateSignatureIdToken(r.idToken,e.jwtKeys,t).pipe(ce(oe=>{if(!oe)return this.loggerService.logDebug(t,"authCallback Signature validation failed id_token"),r.state=D.SignatureFailed,this.handleUnsuccessfulValidation(t),p(r);let Te=this.storagePersistenceService.read("authNonce",t);if(!this.tokenValidationService.validateIdTokenNonce(r.decodedIdToken,Te,!!X,t))return this.loggerService.logWarning(t,"authCallback incorrect nonce, did you call the checkAuth() method multiple times?"),r.state=D.IncorrectNonce,this.handleUnsuccessfulValidation(t),p(r);if(!this.tokenValidationService.validateRequiredIdToken(r.decodedIdToken,t))return this.loggerService.logDebug(t,"authCallback Validation, one of the REQUIRED properties missing from id_token"),r.state=D.RequiredPropertyMissing,this.handleUnsuccessfulValidation(t),p(r);if(!d&&!this.tokenValidationService.validateIdTokenIatMaxOffset(r.decodedIdToken,w??120,!!m,t))return this.loggerService.logWarning(t,"authCallback Validation, iat rejected id_token was issued too far away from the current time"),r.state=D.MaxOffsetExpired,this.handleUnsuccessfulValidation(t),p(r);let R=this.storagePersistenceService.read("authWellKnownEndPoints",t);if(R){if(S)this.loggerService.logDebug(t,"iss validation is turned off, this is not recommended!");else if(!S&&!this.tokenValidationService.validateIdTokenIss(r.decodedIdToken,R.issuer,t))return this.loggerService.logWarning(t,"authCallback incorrect iss does not match authWellKnownEndpoints issuer"),r.state=D.IssDoesNotMatchIssuer,this.handleUnsuccessfulValidation(t),p(r)}else return this.loggerService.logWarning(t,"authWellKnownEndpoints is undefined"),r.state=D.NoAuthWellKnownEndPoints,this.handleUnsuccessfulValidation(t),p(r);return this.tokenValidationService.validateIdTokenAud(r.decodedIdToken,g,t)?this.tokenValidationService.validateIdTokenAzpExistsIfMoreThanOneAud(r.decodedIdToken)?this.tokenValidationService.validateIdTokenAzpValid(r.decodedIdToken,g)?this.isIdTokenAfterRefreshTokenRequestValid(e,r.decodedIdToken,t)?!d&&!this.tokenValidationService.validateIdTokenExpNotExpired(r.decodedIdToken,t,z)?(this.loggerService.logWarning(t,"authCallback id token expired"),r.state=D.TokenExpired,this.handleUnsuccessfulValidation(t),p(r)):this.validateDefault(a,c,r,t,e):(this.loggerService.logWarning(t,"authCallback pre, post id_token claims do not match in refresh"),r.state=D.IncorrectIdTokenClaimsAfterRefresh,this.handleUnsuccessfulValidation(t),p(r)):(this.loggerService.logWarning(t,"authCallback incorrect azp"),r.state=D.IncorrectAzp,this.handleUnsuccessfulValidation(t),p(r)):(this.loggerService.logWarning(t,"authCallback missing azp"),r.state=D.IncorrectAzp,this.handleUnsuccessfulValidation(t),p(r)):(this.loggerService.logWarning(t,"authCallback incorrect aud"),r.state=D.IncorrectAud,this.handleUnsuccessfulValidation(t),p(r))}))}else this.loggerService.logDebug(t,"No id_token found, skipping id_token validation");return this.validateDefault(a,c,r,t,e)}validateDefault(e,t,r,n,a){if(!e&&!t)return r.authResponseIsValid=!0,r.state=D.Ok,this.handleSuccessfulValidation(n),this.handleUnsuccessfulValidation(n),p(r);if(a.authResult?.id_token){let c=this.tokenHelperService.getHeaderFromToken(r.idToken,!1,n);if(t&&!r.decodedIdToken.at_hash)this.loggerService.logDebug(n,"Code Flow active, and no at_hash in the id_token, skipping check!");else return this.tokenValidationService.validateIdTokenAtHash(r.accessToken,r.decodedIdToken.at_hash,c.alg,n).pipe(b(h=>!h||!r.accessToken?(this.loggerService.logWarning(n,"authCallback incorrect at_hash"),r.state=D.IncorrectAtHash,this.handleUnsuccessfulValidation(n),r):(r.authResponseIsValid=!0,r.state=D.Ok,this.handleSuccessfulValidation(n),r)))}return r.authResponseIsValid=!0,r.state=D.Ok,this.handleSuccessfulValidation(n),p(r)}isIdTokenAfterRefreshTokenRequestValid(e,t,r){let{useRefreshToken:n,disableRefreshIdTokenAuthTimeValidation:a}=r;if(!n||!e.existingIdToken)return!0;let c=this.tokenHelperService.getPayloadFromToken(e.existingIdToken,!1,r);return c.iss!==t.iss?(this.loggerService.logDebug(r,`iss do not match: ${c.iss} ${t.iss}`),!1):c.azp!==t.azp?(this.loggerService.logDebug(r,`azp do not match: ${c.azp} ${t.azp}`),!1):c.sub!==t.sub?(this.loggerService.logDebug(r,`sub do not match: ${c.sub} ${t.sub}`),!1):this.equalityService.isStringEqualOrNonOrderedArrayEqual(c?.aud,t?.aud)?a?!0:c.auth_time!==t.auth_time?(this.loggerService.logDebug(r,`auth_time do not match: ${c.auth_time} ${t.auth_time}`),!1):!0:(this.loggerService.logDebug(r,`aud in new id_token is not valid: '${c?.aud}' '${t.aud}'`),!1)}handleSuccessfulValidation(e){let{autoCleanStateAfterAuthentication:t}=e;this.storagePersistenceService.write("authNonce",null,e),t&&this.storagePersistenceService.write("authStateControl","",e),this.loggerService.logDebug(e,"authCallback token(s) validated, continue")}handleUnsuccessfulValidation(e){let{autoCleanStateAfterAuthentication:t}=e;this.storagePersistenceService.write("authNonce",null,e),t&&this.storagePersistenceService.write("authStateControl","",e),this.loggerService.logDebug(e,"authCallback token(s) invalid")}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),nn=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.stateValidationService=l(sn),this.authStateService=l(Y),this.resetAuthDataService=l(ne),this.document=l(C)}callbackStateValidation(e,t,r){return this.stateValidationService.getValidatedStateResult(e,t).pipe(b(n=>{if(e.validationResult=n,n.authResponseIsValid)return this.authStateService.setAuthorizationData(n.accessToken,e.authResult,t,r),e;{let a=`authorizedCallback, token(s) validation failed, resetting. Hash: ${this.document.location.hash}`;throw this.loggerService.logWarning(t,a),this.resetAuthDataService.resetAuthorizationData(t,r),this.publishUnauthorizedState(e.validationResult,e.isRenewProcess,t.configId),new Error(a)}}))}publishUnauthorizedState(e,t,r){this.authStateService.updateAndPublishAuthState({isAuthenticated:!1,validationResult:e.state,isRenewProcess:t,configId:r})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),on=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.authStateService=l(Y),this.flowsDataService=l(U),this.userService=l(Ce),this.resetAuthDataService=l(ne)}callbackUser(e,t,r){let{isRenewProcess:n,validationResult:a,authResult:c,refreshToken:h}=e,{autoUserInfo:d,renewUserInfoAfterTokenRenew:u}=t;return d?this.userService.getAndPersistUserDataInStore(t,r,n,a?.idToken,a?.decodedIdToken).pipe(I(g=>{if(g)return h||this.flowsDataService.setSessionState(c?.session_state,t),this.publishAuthState(a,n,t.configId),p(e);{this.resetAuthDataService.resetAuthorizationData(t,r),this.publishUnauthenticatedState(a,n,t.configId);let S=`Called for userData but they were ${g}`;return this.loggerService.logWarning(t,S),v(()=>new Error(S))}}),A(g=>{let S=`Failed to retrieve user info with error:  ${g}`;return this.loggerService.logWarning(t,S),v(()=>new Error(S))})):((!n||u)&&a?.decodedIdToken&&this.userService.setUserDataToStore(a.decodedIdToken,t,r),!n&&!h&&this.flowsDataService.setSessionState(c?.session_state,t),this.publishAuthState(a,n,t.configId),p(e))}publishAuthState(e,t,r){e&&this.authStateService.updateAndPublishAuthState({isAuthenticated:!0,validationResult:e.state,isRenewProcess:t,configId:r})}publishUnauthenticatedState(e,t,r){e&&this.authStateService.updateAndPublishAuthState({isAuthenticated:!1,validationResult:e.state,isRenewProcess:t,configId:r})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),St=(()=>{let i=class i{constructor(){this.codeFlowCallbackHandlerService=l(qs),this.implicitFlowCallbackHandlerService=l(Qs),this.historyJwtKeysCallbackHandlerService=l(Js),this.userHandlerService=l(on),this.stateValidationCallbackHandlerService=l(nn),this.refreshSessionCallbackHandlerService=l(en),this.refreshTokenCallbackHandlerService=l(tn)}processCodeFlowCallback(e,t,r){return this.codeFlowCallbackHandlerService.codeFlowCallback(e,t).pipe(k(n=>this.codeFlowCallbackHandlerService.codeFlowCodeRequest(n,t)),k(n=>this.historyJwtKeysCallbackHandlerService.callbackHistoryAndResetJwtKeys(n,t,r)),k(n=>this.stateValidationCallbackHandlerService.callbackStateValidation(n,t,r)),k(n=>this.userHandlerService.callbackUser(n,t,r)))}processSilentRenewCodeFlowCallback(e,t,r){return this.codeFlowCallbackHandlerService.codeFlowCodeRequest(e,t).pipe(k(n=>this.historyJwtKeysCallbackHandlerService.callbackHistoryAndResetJwtKeys(n,t,r)),k(n=>this.stateValidationCallbackHandlerService.callbackStateValidation(n,t,r)),k(n=>this.userHandlerService.callbackUser(n,t,r)))}processImplicitFlowCallback(e,t,r){return this.implicitFlowCallbackHandlerService.implicitFlowCallback(e,t,r).pipe(k(n=>this.historyJwtKeysCallbackHandlerService.callbackHistoryAndResetJwtKeys(n,e,t)),k(n=>this.stateValidationCallbackHandlerService.callbackStateValidation(n,e,t)),k(n=>this.userHandlerService.callbackUser(n,e,t)))}processRefreshToken(e,t,r){return this.refreshSessionCallbackHandlerService.refreshSessionWithRefreshTokens(e).pipe(k(n=>this.refreshTokenCallbackHandlerService.refreshTokensRequestTokens(n,e,r)),k(n=>this.historyJwtKeysCallbackHandlerService.callbackHistoryAndResetJwtKeys(n,e,t)),k(n=>this.stateValidationCallbackHandlerService.callbackStateValidation(n,e,t)),k(n=>this.userHandlerService.callbackUser(n,e,t)))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),$e=(()=>{let i=class i{constructor(){this.runTokenValidationRunning=null,this.zone=l(M),this.document=l(C)}isTokenValidationRunning(){return!!this.runTokenValidationRunning}stopPeriodicTokenCheck(){this.runTokenValidationRunning&&(this.runTokenValidationRunning.unsubscribe(),this.runTokenValidationRunning=null)}startPeriodicTokenCheck(e){let t=e*1e3;return new le(r=>{let n;return this.zone.runOutsideAngular(()=>{n=this.document?.defaultView?.setInterval(()=>this.zone.run(()=>r.next()),t)}),()=>{clearInterval(n)}})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),an=(()=>{let i=class i{constructor(){this.flowsService=l(St),this.router=l(ke),this.flowsDataService=l(U),this.intervalService=l($e)}authenticatedCallbackWithCode(e,t,r){let n=this.flowsDataService.isSilentRenewRunning(t),{triggerAuthorizationResultEvent:a}=t,c=t.postLoginRoute||"/",h=t.unauthorizedRoute||"/";return this.flowsService.processCodeFlowCallback(e,t,r).pipe(x(d=>{this.flowsDataService.resetCodeFlowInProgress(t),!a&&!d.isRenewProcess&&this.router.navigateByUrl(c)}),A(d=>(this.flowsDataService.resetSilentRenewRunning(t),this.flowsDataService.resetCodeFlowInProgress(t),this.intervalService.stopPeriodicTokenCheck(),!a&&!n&&this.router.navigateByUrl(h),v(()=>new Error(d)))))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Ur=(()=>{let i=class i{constructor(){this.flowsService=l(St),this.router=l(ke),this.flowsDataService=l(U),this.intervalService=l($e)}authenticatedImplicitFlowCallback(e,t,r){let n=this.flowsDataService.isSilentRenewRunning(e),a=!!e.triggerAuthorizationResultEvent,c=e.postLoginRoute??"",h=e.unauthorizedRoute??"";return this.flowsService.processImplicitFlowCallback(e,t,r).pipe(x(d=>{!a&&!d.isRenewProcess&&this.router.navigateByUrl(c)}),A(d=>(this.flowsDataService.resetSilentRenewRunning(e),this.intervalService.stopPeriodicTokenCheck(),!a&&!n&&this.router.navigateByUrl(h),v(()=>new Error(d)))))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Wr=(()=>{let i=class i{constructor(){this.urlService=l(G),this.flowHelper=l(se),this.implicitFlowCallbackService=l(Ur),this.codeFlowCallbackService=l(an),this.stsCallbackInternal$=new T}get stsCallback$(){return this.stsCallbackInternal$.asObservable()}isCallback(e,t){return e?this.urlService.isCallbackFromSts(e,t):!1}handleCallbackAndFireEvents(e,t,r){let n=new le;if(this.flowHelper.isCurrentFlowCodeFlow(t))n=this.codeFlowCallbackService.authenticatedCallbackWithCode(e,t,r);else if(this.flowHelper.isCurrentFlowAnyImplicitFlow(t))if(e?.includes("#")){let a=e.substring(e.indexOf("#")+1);n=this.implicitFlowCallbackService.authenticatedImplicitFlowCallback(t,r,a)}else n=this.implicitFlowCallbackService.authenticatedImplicitFlowCallback(t,r);return n.pipe(x(()=>this.stsCallbackInternal$.next()))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),ln=(()=>{let i=class i{constructor(){this.platformId=l(Oi)}isBrowser(){return $i(this.platformId)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Pr="/.well-known/openid-configuration",cn=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.http=l(pe)}getWellKnownEndPointsForConfig(e){let{authWellknownEndpointUrl:t,authWellknownEndpoints:r={}}=e;if(!t){let n="no authWellknownEndpoint given!";return this.loggerService.logError(e,n),v(()=>new Error(n))}return this.getWellKnownDocument(t,e).pipe(b(n=>({issuer:n.issuer,jwksUri:n.jwks_uri,authorizationEndpoint:n.authorization_endpoint,tokenEndpoint:n.token_endpoint,userInfoEndpoint:n.userinfo_endpoint,endSessionEndpoint:n.end_session_endpoint,checkSessionIframe:n.check_session_iframe,revocationEndpoint:n.revocation_endpoint,introspectionEndpoint:n.introspection_endpoint,parEndpoint:n.pushed_authorization_request_endpoint})),b(n=>y(y({},n),r)),x(n=>{let a=n.issuer||"",c=e.authWellknownUrlSuffix||Pr,h=t.replace(c,"");if(a!==h&&a!==`${h}/`){let d=`Issuer mismatch. Well known issuer ${n.issuer} does not match configured well known url ${t}`;throw this.loggerService.logError(e,d),new Error(d)}}))}getWellKnownDocument(e,t){let r=e,n=t.authWellknownUrlSuffix||Pr;return e.includes(n)||(r=`${e}${n}`),this.http.get(r,t).pipe(Se(2))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),De=(()=>{let i=class i{constructor(){this.dataService=l(cn),this.publicEventsService=l(fe),this.storagePersistenceService=l(P)}storeWellKnownEndpoints(e,t){this.storagePersistenceService.write("authWellKnownEndPoints",t,e)}queryAndStoreAuthWellKnownEndPoints(e){return e?this.dataService.getWellKnownEndPointsForConfig(e).pipe(x(t=>this.storeWellKnownEndpoints(e,t)),A(t=>(this.publicEventsService.fireEvent(F.ConfigLoadingFailed,null),v(()=>new Error(t))))):v(()=>new Error("Please provide a configuration before setting up the module"))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),hn={authority:"https://please_set",authWellknownEndpointUrl:"",authWellknownEndpoints:void 0,redirectUrl:"https://please_set",checkRedirectUrlWhenCheckingIfIsCallback:!0,clientId:"please_set",responseType:"code",scope:"openid email profile",hdParam:"",postLogoutRedirectUri:"https://please_set",startCheckSession:!1,silentRenew:!1,silentRenewUrl:"https://please_set",silentRenewTimeoutInSeconds:20,renewTimeBeforeTokenExpiresInSeconds:0,useRefreshToken:!1,usePushedAuthorisationRequests:!1,ignoreNonceAfterRefresh:!1,postLoginRoute:"/",forbiddenRoute:"/forbidden",unauthorizedRoute:"/unauthorized",autoUserInfo:!0,autoCleanStateAfterAuthentication:!0,triggerAuthorizationResultEvent:!1,logLevel:je.Warn,issValidationOff:!1,historyCleanupOff:!1,maxIdTokenIatOffsetAllowedInSeconds:120,disableIatOffsetValidation:!1,customParamsAuthRequest:{},customParamsRefreshTokenRequest:{},customParamsEndSessionRequest:{},customParamsCodeRequest:{},disableRefreshIdTokenAuthTimeValidation:!1,triggerRefreshWhenIdTokenExpired:!0,tokenRefreshInSeconds:4,refreshTokenRetryInSeconds:3,ngswBypass:!1},Ie={result:!0,messages:[],level:"none"},dn=s=>s.authority?Ie:{result:!1,messages:["The authority URL MUST be provided in the configuration! "],level:"error"},un=s=>s.clientId?Ie:{result:!1,messages:["The clientId is required and missing from your config!"],level:"error"},fn=s=>{if(!s)return"";let{authority:i,clientId:o,scope:e}=s;return`${i}${o}${e}`},pn=s=>new Set(s).size!==s.length,gn=s=>{let i=s.map(t=>fn(t));return i.some(t=>t==="")?{result:!1,messages:["Please make sure you add an object with a 'config' property: ....({ config }) instead of ...(config)"],level:"error"}:pn(i)?{result:!1,messages:["You added multiple configs with the same authority, clientId and scope"],level:"warning"}:Ie},vn=s=>s.redirectUrl?Ie:{result:!1,messages:["The redirectUrl is required and missing from your config"],level:"error"},mn=s=>{let i=s.silentRenew,o=s.useRefreshToken,e=s.silentRenewUrl;return i&&!o&&!e?{result:!1,messages:["Please provide a silent renew URL if using renew and not refresh tokens"],level:"error"}:Ie},Sn=s=>{let i=s.useRefreshToken,o=s.silentRenew,t=(s.scope||"").split(" ").includes("offline_access");return i&&o&&!t?{result:!1,messages:["When using silent renew and refresh tokens please set the `offline_access` scope"],level:"warning"}:Ie},yn=[dn,Sn,vn,un,mn],_n=[gn],wn=(()=>{let i=class i{constructor(){this.loggerService=l(_)}validateConfigs(e){return this.validateConfigsInternal(e??[],_n)}validateConfig(e){return this.validateConfigInternal(e,yn)}validateConfigsInternal(e,t){if(e.length===0)return!1;let r=t.map(a=>a(e)),n=0;return e.forEach(a=>{let c=this.processValidationResultsAndGetErrorCount(r,a);n+=c}),n===0}validateConfigInternal(e,t){let r=t.map(a=>a(e));return this.processValidationResultsAndGetErrorCount(r,e)===0}processValidationResultsAndGetErrorCount(e,t){let r=e.filter(c=>c.messages.length>0),n=this.getAllMessagesOfType("error",r),a=this.getAllMessagesOfType("warning",r);return n.forEach(c=>this.loggerService.logError(t,c)),a.forEach(c=>this.loggerService.logWarning(t,c)),n.length}getAllMessagesOfType(e,t){return t.filter(n=>n.level===e).map(n=>n.messages).reduce((n,a)=>n.concat(a),[])}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),ai=(()=>{let i=class i{constructor(){this.configsInternal={},this.loggerService=l(_),this.publicEventsService=l(fe),this.storagePersistenceService=l(P),this.platformProvider=l(ln),this.authWellKnownService=l(De),this.loader=l(pt),this.configValidationService=l(wn)}hasManyConfigs(){return Object.keys(this.configsInternal).length>1}getAllConfigurations(){return Object.values(this.configsInternal)}getOpenIDConfiguration(e){return this.configsAlreadySaved()?p(this.getConfig(e)):this.getOpenIDConfigurations(e).pipe(b(t=>t.currentConfig))}getOpenIDConfigurations(e){return this.loadConfigs().pipe(k(t=>this.prepareAndSaveConfigs(t)),b(t=>({allConfigs:t,currentConfig:this.getConfig(e)})))}hasAtLeastOneConfig(){return Object.keys(this.configsInternal).length>0}saveConfig(e){let{configId:t}=e;this.configsInternal[t]=e}loadConfigs(){return this.loader.loadConfigs()}configsAlreadySaved(){return this.hasAtLeastOneConfig()}getConfig(e){if(e){let r=this.configsInternal[e];return!r&&Hi()&&console.warn(`[angular-auth-oidc-client] No configuration found for config id '${e}'.`),r||null}let[,t]=Object.entries(this.configsInternal)[0]||[[null,null]];return t||null}prepareAndSaveConfigs(e){if(!this.configValidationService.validateConfigs(e))return p([]);this.createUniqueIds(e);let t=e.map(r=>this.handleConfig(r));return me(t).pipe(b(r=>r.filter(n=>!!n)),b(r=>r))}createUniqueIds(e){e.forEach((t,r)=>{t.configId||(t.configId=`${r}-${t.clientId}`)})}handleConfig(e){if(!this.configValidationService.validateConfig(e))return this.loggerService.logError(e,"Validation of config rejected with errors. Config is NOT set."),p(null);e.authWellknownEndpointUrl||(e.authWellknownEndpointUrl=e.authority);let t=this.prepareConfig(e);this.saveConfig(t);let r=this.enhanceConfigWithWellKnownEndpoint(t);return this.publicEventsService.fireEvent(F.ConfigLoaded,r),p(t)}enhanceConfigWithWellKnownEndpoint(e){let t=this.storagePersistenceService.read("authWellKnownEndPoints",e);if(t)return e.authWellknownEndpoints=t,e;let r=e.authWellknownEndpoints;return r&&(this.authWellKnownService.storeWellKnownEndpoints(e,r),e.authWellknownEndpoints=r),e}prepareConfig(e){let t=y(y({},hn),e);return this.setSpecialCases(t),t}setSpecialCases(e){this.platformProvider.isBrowser()||(e.startCheckSession=!1,e.silentRenew=!1,e.useRefreshToken=!1,e.usePushedAuthorisationRequests=!1)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Vr=(()=>{let i=class i{constructor(){this.document=l(C),this.loggerService=l(_)}getExistingIFrame(e){let t=this.getIFrameFromParentWindow(e);if(this.isIFrameElement(t))return t;let r=this.getIFrameFromWindow(e);return this.isIFrameElement(r)?r:null}addIFrameToWindowBody(e,t){let r=this.document.createElement("iframe");return r.id=e,r.title=e,this.loggerService.logDebug(t,r),r.style.display="none",this.document.body.appendChild(r),r}getIFrameFromParentWindow(e){try{let t=this.document.defaultView?.parent.document.getElementById(e);return this.isIFrameElement(t)?t:null}catch{return null}}getIFrameFromWindow(e){let t=this.document.getElementById(e);return this.isIFrameElement(t)?t:null}isIFrameElement(e){return!!e&&e instanceof HTMLIFrameElement}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),bn="myiFrameForSilentRenew",Lr=s=>`${bn}_${s}`,li=(()=>{let i=class i{constructor(){this.refreshSessionWithIFrameCompletedInternal$=new T,this.loggerService=l(_),this.iFrameService=l(Vr),this.flowsService=l(St),this.resetAuthDataService=l(ne),this.flowsDataService=l(U),this.authStateService=l(Y),this.flowHelper=l(se),this.implicitFlowCallbackService=l(Ur),this.intervalService=l($e)}get refreshSessionWithIFrameCompleted$(){return this.refreshSessionWithIFrameCompletedInternal$.asObservable()}getOrCreateIframe(e){let t=Lr(e.configId),r=this.iFrameService.getExistingIFrame(t);return r?(this.loggerService.logDebug(e,`Using existing iframe: ${t}`),r):(this.loggerService.logDebug(e,`Creating new iframe: ${t}`),this.iFrameService.addIFrameToWindowBody(t,e))}isSilentRenewConfigured(e){let{useRefreshToken:t,silentRenew:r}=e;return!t&&!!r}codeFlowCallbackSilentRenewIframe(e,t,r){let n=new at({fromString:e[1]}),a=n.get("error");if(a)return this.authStateService.updateAndPublishAuthState({isAuthenticated:!1,validationResult:D.LoginRequired,isRenewProcess:!0,configId:t.configId}),this.resetAuthDataService.resetAuthorizationData(t,r),this.flowsDataService.setNonce("",t),this.intervalService.stopPeriodicTokenCheck(),v(()=>new Error(a));let c=n.get("code")??"",h=n.get("state")??"",d=n.get("session_state"),u={code:c,refreshToken:"",state:h,sessionState:d,authResult:null,isRenewProcess:!0,jwtKeys:null,validationResult:null,existingIdToken:null};return this.flowsService.processSilentRenewCodeFlowCallback(u,t,r).pipe(A(g=>(this.intervalService.stopPeriodicTokenCheck(),this.resetAuthDataService.resetAuthorizationData(t,r),v(()=>new Error(g)))))}silentRenewEventHandler(e,t,r){if(this.loggerService.logDebug(t,"silentRenewEventHandler"),!e.detail)return;let n;if(this.flowHelper.isCurrentFlowCodeFlow(t)){let c=e.detail.toString().split("?");n=this.codeFlowCallbackSilentRenewIframe(c,t,r)}else n=this.implicitFlowCallbackService.authenticatedImplicitFlowCallback(t,r,e.detail);n.subscribe({next:({authResult:c})=>{this.refreshSessionWithIFrameCompletedInternal$.next({authResult:c,configId:t.configId,success:!0}),this.flowsDataService.resetSilentRenewRunning(t)},error:c=>{this.loggerService.logError(t,"Error: "+c),this.refreshSessionWithIFrameCompletedInternal$.next({configId:t.configId,success:!1}),this.flowsDataService.resetSilentRenewRunning(t)}})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Nr=(()=>{let i=class i{constructor(){this.renderer=l(J).createRenderer(null,null),this.loggerService=l(_),this.urlService=l(G),this.silentRenewService=l(li),this.document=l(C)}refreshSessionWithIframe(e,t,r){return this.loggerService.logDebug(e,"BEGIN refresh session Authorize Iframe renew"),this.urlService.getRefreshSessionSilentRenewUrl(e,r).pipe(I(n=>this.sendAuthorizeRequestUsingSilentRenew(n,e,t)))}sendAuthorizeRequestUsingSilentRenew(e,t,r){let n=this.silentRenewService.getOrCreateIframe(t);return this.initSilentRenewRequest(t,r),this.loggerService.logDebug(t,`sendAuthorizeRequestUsingSilentRenew for URL: ${e}`),new le(a=>{let c=()=>{n.removeEventListener("load",c),this.loggerService.logDebug(t,"removed event listener from IFrame"),a.next(!0),a.complete()};n.addEventListener("load",c),n.contentWindow?.location.replace(e??"")})}initSilentRenewRequest(e,t){let r=Math.random();this.loggerService.logDebug(e,`Creating new silent renew handlers for config: ${e.configId}, instance: ${r}`);let n=this.renderer.listen("window","oidc-silent-renew-init",c=>{let h=c.detail;h.configId===e.configId&&h.instanceId!==r&&(this.loggerService.logDebug(e,`Destroying old handlers for config: ${e.configId} (old instance: ${r}, new instance: ${h.instanceId})`),n(),a())}),a=this.renderer.listen("window","oidc-silent-renew-message",c=>{if(this.shouldProcessRenewMessage(c,e)){let h=this.convertToLegacyEvent(c);this.silentRenewService.silentRenewEventHandler(h,e,t)}});this.document.defaultView?.dispatchEvent(new CustomEvent("oidc-silent-renew-init",{detail:{instanceId:r,configId:e.configId}}))}shouldProcessRenewMessage(e,t){if(!e?.detail)return this.loggerService.logDebug(t,`Silent renew event has no valid payload: ${e?.detail}`),!1;if(e.detail.srcFrameId){let r=Lr(t.configId)===e.detail.srcFrameId;return this.loggerService.logDebug(t,`Silent renew event from frame: ${e.detail.srcFrameId}, current configId: ${t.configId}, processing: ${r}`),r}return this.loggerService.logDebug(t,"Silent renew event without srcFrameId - processing for backward compatibility"),!0}convertToLegacyEvent(e){return e?.detail?.url?new CustomEvent(e.type,{detail:e.detail.url}):e}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Hr=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.resetAuthDataService=l(ne),this.flowsService=l(St),this.intervalService=l($e)}refreshSessionWithRefreshTokens(e,t,r){this.loggerService.logDebug(e,"BEGIN refresh session Authorize");let n=!1;return this.flowsService.processRefreshToken(e,t,r).pipe(A(a=>(this.resetAuthDataService.resetAuthorizationData(e,t),n=!0,v(()=>new Error(a)))),Ei(()=>n&&this.intervalService.stopPeriodicTokenCheck()))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),kn=(()=>{let i=class i{constructor(){this.resetAuthDataService=l(ne),this.flowHelper=l(se),this.flowsDataService=l(U),this.loggerService=l(_),this.userService=l(Ce),this.authStateService=l(Y),this.refreshSessionIframeService=l(Nr),this.refreshSessionRefreshTokenService=l(Hr),this.intervalService=l($e),this.storagePersistenceService=l(P),this.publicEventsService=l(fe),this.configurationService=l(ai)}startTokenValidationPeriodically(e,t){let r=this.getConfigsWithSilentRenewEnabled(e);if(r.length<=0||this.intervalService.isTokenValidationRunning())return;let n=this.getSmallestRefreshTimeFromConfigs(r),a=this.intervalService.startPeriodicTokenCheck(n).pipe(I(()=>{let c={};return r.forEach(h=>{let d=h.configId;c[d]=this.getRefreshEvent(h,e)}),me(c)}));this.intervalService.runTokenValidationRunning=a.pipe(A(c=>v(()=>new Error(c)))).subscribe({next:c=>{for(let[h,d]of Object.entries(c))this.configurationService.getOpenIDConfiguration(h).subscribe(u=>{this.loggerService.logDebug(u,"silent renew, periodic check finished!"),this.flowHelper.isCurrentFlowCodeFlowWithRefreshTokens(u)&&this.flowsDataService.resetSilentRenewRunning(u)})},error:c=>{this.loggerService.logError(t,"silent renew failed!",c)}})}getRefreshEvent(e,t){if(!this.shouldStartPeriodicallyCheckForConfig(e))return p(null);let n=this.createRefreshEventForConfig(e,t);return this.publicEventsService.fireEvent(F.SilentRenewStarted),n.pipe(A(a=>(this.loggerService.logError(e,"silent renew failed!",a),this.publicEventsService.fireEvent(F.SilentRenewFailed,a),this.flowsDataService.resetSilentRenewRunning(e),v(()=>new Error(a)))))}getSmallestRefreshTimeFromConfigs(e){return e.reduce((r,n)=>(r.tokenRefreshInSeconds??0)<(n.tokenRefreshInSeconds??0)?r:n).tokenRefreshInSeconds??0}getConfigsWithSilentRenewEnabled(e){return e.filter(t=>t.silentRenew)}createRefreshEventForConfig(e,t){return this.loggerService.logDebug(e,"starting silent renew..."),this.configurationService.getOpenIDConfiguration(e.configId).pipe(I(r=>{if(!r?.silentRenew)return this.resetAuthDataService.resetAuthorizationData(r,t),p(null);if(this.flowsDataService.setSilentRenewRunning(r),this.flowHelper.isCurrentFlowCodeFlowWithRefreshTokens(r)){let a=this.storagePersistenceService.read("storageCustomParamsRefresh",r)||{},{customParamsRefreshTokenRequest:c}=r,h=y(y({},c),a);return this.refreshSessionRefreshTokenService.refreshSessionWithRefreshTokens(r,t,h)}let n=this.storagePersistenceService.read("storageCustomParamsAuthRequest",r);return this.refreshSessionIframeService.refreshSessionWithIframe(r,t,n)}))}shouldStartPeriodicallyCheckForConfig(e){let t=this.authStateService.getIdToken(e),r=this.flowsDataService.isSilentRenewRunning(e),n=this.flowsDataService.isCodeFlowInProgress(e),a=this.userService.getUserDataFromStore(e);if(this.loggerService.logDebug(e,`Checking: silentRenewRunning: ${r}, isCodeFlowInProgress: ${n} - has idToken: ${!!t} - has userData: ${!!a}`),!(!!a&&!r&&!!t&&!n))return!1;let h=this.authStateService.hasIdTokenExpiredAndRenewCheckIsEnabled(e),d=this.authStateService.hasAccessTokenExpiredIfExpiryExists(e);return h||d}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Rn=3,Br=(()=>{let i=class i{constructor(){this.flowHelper=l(se),this.flowsDataService=l(U),this.loggerService=l(_),this.silentRenewService=l(li),this.authStateService=l(Y),this.authWellKnownService=l(De),this.refreshSessionIframeService=l(Nr),this.storagePersistenceService=l(P),this.refreshSessionRefreshTokenService=l(Hr),this.userService=l(Ce)}userForceRefreshSession(e,t,r){return e?(this.persistCustomParams(r,e),this.forceRefreshSession(e,t,r).pipe(x(()=>this.flowsDataService.resetSilentRenewRunning(e)))):v(()=>new Error("Please provide a configuration before setting up the module"))}forceRefreshSession(e,t,r){let{customParamsRefreshTokenRequest:n,configId:a}=e,c=y(y({},n),r);if(this.flowHelper.isCurrentFlowCodeFlowWithRefreshTokens(e))return this.startRefreshSession(e,t,c).pipe(b(()=>{let u=this.authStateService.areAuthStorageTokensValid(e);return u?{idToken:this.authStateService.getIdToken(e),accessToken:this.authStateService.getAccessToken(e),userData:this.userService.getUserDataFromStore(e),isAuthenticated:u,configId:a}:{isAuthenticated:!1,errorMessage:"",userData:null,idToken:"",accessToken:"",configId:a}}));let{silentRenewTimeoutInSeconds:h}=e,d=(h??0)*1e3;return me([this.startRefreshSession(e,t,r),this.silentRenewService.refreshSessionWithIFrameCompleted$.pipe(ee(u=>u?.configId===e.configId),xe(1))]).pipe(Ii(d),tt(u=>u.pipe(ce((g,S)=>{let m=S+1;return!(g instanceof Di)||m>Rn?v(()=>new Error(g)):(this.loggerService.logDebug(e,`forceRefreshSession timeout. Attempt #${m}`),this.flowsDataService.resetSilentRenewRunning(e),et(m*1e3))}))),b(([u,g])=>{let S=this.authStateService.areAuthStorageTokensValid(e);if(S){let w=g.success?g.authResult:null;return{idToken:w?.id_token??"",accessToken:w?.access_token??"",userData:this.userService.getUserDataFromStore(e),isAuthenticated:S,configId:a}}return{isAuthenticated:!1,errorMessage:"",userData:null,idToken:"",accessToken:"",configId:a}}))}persistCustomParams(e,t){let{useRefreshToken:r}=t;e&&(r?this.storagePersistenceService.write("storageCustomParamsRefresh",e,t):this.storagePersistenceService.write("storageCustomParamsAuthRequest",e,t))}startRefreshSession(e,t,r){let n=this.flowsDataService.isSilentRenewRunning(e);return this.loggerService.logDebug(e,`Checking: silentRenewRunning: ${n}`),!n?this.authWellKnownService.queryAndStoreAuthWellKnownEndPoints(e).pipe(I(()=>(this.flowsDataService.setSilentRenewRunning(e),this.flowHelper.isCurrentFlowCodeFlowWithRefreshTokens(e)?this.refreshSessionRefreshTokenService.refreshSessionWithRefreshTokens(e,t,r):this.refreshSessionIframeService.refreshSessionWithIframe(e,t,r)))):p(null)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Ar="myiFrameForCheckSession",ci=(()=>{let i=class i{constructor(){this.checkSessionReceived=!1,this.scheduledHeartBeatRunning=null,this.lastIFrameRefresh=0,this.outstandingMessages=0,this.loggerService=l(_),this.storagePersistenceService=l(P),this.iFrameService=l(Vr),this.eventService=l(fe),this.zone=l(M),this.document=l(C),this.heartBeatInterval=3e3,this.iframeRefreshInterval=6e4,this.checkSessionChangedInternal$=new Ze(!1)}get checkSessionChanged$(){return this.checkSessionChangedInternal$.asObservable()}ngOnDestroy(){this.stop();let e=this.document.defaultView;e&&this.iframeMessageEventListener&&e.removeEventListener("message",this.iframeMessageEventListener,!1)}isCheckSessionConfigured(e){let{startCheckSession:t}=e;return!!t}start(e){if(this.scheduledHeartBeatRunning)return;let{clientId:t}=e;this.pollServerSession(t,e)}stop(){this.scheduledHeartBeatRunning&&(this.clearScheduledHeartBeat(),this.checkSessionReceived=!1)}serverStateChanged(e){let{startCheckSession:t}=e;return!!t&&this.checkSessionReceived}getExistingIframe(){return this.iFrameService.getExistingIFrame(Ar)}init(e){if(this.lastIFrameRefresh+this.iframeRefreshInterval>Date.now())return p();let t=this.storagePersistenceService.read("authWellKnownEndPoints",e);if(!t)return this.loggerService.logWarning(e,"CheckSession - init check session: authWellKnownEndpoints is undefined. Returning."),p();let r=this.getOrCreateIframe(e);this.bindMessageEventToIframe(e);let n=t.checkSessionIframe,a=r.contentWindow;return n?(a?a.location.replace(n):this.loggerService.logWarning(e,"CheckSession - init check session: IFrame contentWindow does not exist"),new le(c=>{r.onload=()=>{this.lastIFrameRefresh=Date.now(),c.next(),c.complete()}})):(this.loggerService.logWarning(e,"CheckSession - init check session: checkSessionIframe is not configured to run"),p())}pollServerSession(e,t){this.outstandingMessages=0;let r=()=>{this.init(t).pipe(xe(1)).subscribe(()=>{let n=this.getExistingIframe();if(n&&e){this.loggerService.logDebug(t,`CheckSession - clientId : '${e}' - existingIframe: '${n}'`);let a=this.storagePersistenceService.read("session_state",t),c=this.storagePersistenceService.read("authWellKnownEndPoints",t),h=n.contentWindow;if(a&&c?.checkSessionIframe&&h){let d=new URL(c.checkSessionIframe)?.origin;this.outstandingMessages++,h.postMessage(e+" "+a,d)}else this.loggerService.logDebug(t,`CheckSession - session_state is '${a}' - AuthWellKnownEndPoints is '${JSON.stringify(c,null,2)}'`),this.checkSessionChangedInternal$.next(!0)}else this.loggerService.logWarning(t,`CheckSession - OidcSecurityCheckSession pollServerSession checkSession IFrame does not exist:
               clientId : '${e}' - existingIframe: '${n}'`);this.outstandingMessages>3&&this.loggerService.logError(t,`CheckSession - OidcSecurityCheckSession not receiving check session response messages.
                            Outstanding messages: '${this.outstandingMessages}'. Server unreachable?`),this.zone.runOutsideAngular(()=>{this.scheduledHeartBeatRunning=this.document?.defaultView?.setTimeout(()=>this.zone.run(r),this.heartBeatInterval)??null})})};r()}clearScheduledHeartBeat(){this.scheduledHeartBeatRunning!==null&&(clearTimeout(this.scheduledHeartBeatRunning),this.scheduledHeartBeatRunning=null)}messageHandler(e,t){let r=this.getExistingIframe(),a=!!this.storagePersistenceService.read("authWellKnownEndPoints",e)?.checkSessionIframe?.startsWith(t.origin);this.outstandingMessages=0,r&&a&&t.source===r.contentWindow&&(t.data==="error"?this.loggerService.logWarning(e,"CheckSession - error from check session messageHandler"):t.data==="changed"?(this.loggerService.logDebug(e,`CheckSession - ${t} from check session messageHandler`),this.checkSessionReceived=!0,this.eventService.fireEvent(F.CheckSessionReceived,t.data),this.checkSessionChangedInternal$.next(!0)):(this.eventService.fireEvent(F.CheckSessionReceived,t.data),this.loggerService.logDebug(e,`CheckSession - ${t.data} from check session messageHandler`)))}bindMessageEventToIframe(e){let t=this.document.defaultView;this.iframeMessageEventListener&&t&&t.removeEventListener("message",this.iframeMessageEventListener,!1),this.iframeMessageEventListener=this.messageHandler.bind(this,e),t&&t.addEventListener("message",this.iframeMessageEventListener,!1)}getOrCreateIframe(e){return this.getExistingIframe()||this.iFrameService.addIFrameToWindowBody(Ar,e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),yt=(()=>{let i=class i{constructor(){this.popUp=null,this.handle=-1,this.loggerService=l(_),this.storagePersistenceService=l(P),this.document=l(C),this.STORAGE_IDENTIFIER="popupauth",this.resultInternal$=new T}get result$(){return this.resultInternal$.asObservable()}get windowInternal(){return this.document.defaultView}isCurrentlyInPopup(e){if(this.canAccessSessionStorage()){let t=this.storagePersistenceService.read(this.STORAGE_IDENTIFIER,e),r=this.windowInternal;return r?!!r.opener&&r.opener!==r&&!!t:!1}return!1}openPopUp(e,t,r){let n=this.getOptions(t);this.storagePersistenceService.write(this.STORAGE_IDENTIFIER,"true",r);let a=this.windowInternal;if(!a)return;if(!e){this.loggerService.logError(r,"Could not open popup, url is empty");return}if(this.popUp=a.open(e,"_blank",n),!this.popUp){this.storagePersistenceService.remove(this.STORAGE_IDENTIFIER,r),this.loggerService.logError(r,"Could not open popup");return}this.loggerService.logDebug(r,"Opened popup with url "+e);let c=h=>{if(!h?.data||typeof h.data!="string"){if(r.disableCleaningPopupOnInvalidMessage)return;this.cleanUp(c,r);return}this.loggerService.logDebug(r,"Received message from popup with url "+h.data),this.resultInternal$.next({userClosed:!1,receivedUrl:h.data}),this.cleanUp(c,r)};a.addEventListener("message",c,!1),this.handle=a.setInterval(()=>{this.popUp?.closed&&(this.resultInternal$.next({userClosed:!0,receivedUrl:""}),this.cleanUp(c,r))},200)}sendMessageToMainWindow(e,t){let r=this.windowInternal;if(r&&r.opener){let n=r.location.href;this.sendMessage(e,n,t)}}cleanUp(e,t){let r=this.windowInternal;r&&(r.removeEventListener("message",e,!1),r.clearInterval(this.handle),this.popUp&&(this.storagePersistenceService.remove(this.STORAGE_IDENTIFIER,t),this.popUp.close(),this.popUp=null))}sendMessage(e,t,r){let n=this.windowInternal;if(n){if(!e){this.loggerService.logDebug(r,`Can not send message to parent, no url: '${e}'`);return}n.opener.postMessage(e,t)}}getOptions(e){let t={width:500,height:500,left:50,top:50},r=y(y({},t),e||{}),n=this.windowInternal;if(!n)return"";let a=r.width||t.width,c=r.height||t.height,h=n.screenLeft+(n.outerWidth-a)/2,d=n.screenTop+(n.outerHeight-c)/2;return r.left=h,r.top=d,Object.entries(r).map(([u,g])=>`${encodeURIComponent(u)}=${encodeURIComponent(g)}`).join(",")}canAccessSessionStorage(){return typeof navigator<"u"&&navigator.cookieEnabled&&typeof Storage<"u"}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Cn=(()=>{let i=class i{constructor(){this.document=l(C)}getStateParamFromCurrentUrl(e){let t=e||this.getCurrentUrl();if(!t)return null;let r=new URL(t);return new URLSearchParams(r.search).get("state")}getCurrentUrl(){return this.document?.defaultView?.location.toString()??null}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),hi=(()=>{let i=class i{constructor(){this.checkSessionService=l(ci),this.currentUrlService=l(Cn),this.silentRenewService=l(li),this.userService=l(Ce),this.loggerService=l(_),this.authStateService=l(Y),this.callbackService=l(Wr),this.refreshSessionService=l(Br),this.periodicallyTokenCheckService=l(kn),this.popupService=l(yt),this.autoLoginService=l(zs),this.storagePersistenceService=l(P),this.publicEventsService=l(fe)}checkAuth(e,t,r){if(!e)return v(()=>new Error("Please provide a configuration before setting up the module"));this.publicEventsService.fireEvent(F.CheckingAuth);let n=this.currentUrlService.getStateParamFromCurrentUrl(r);return this.getConfig(e,r)?this.checkAuthWithConfig(e,t,r):v(()=>new Error(`could not find matching config for state ${n}`))}checkAuthMultiple(e,t){let r=this.currentUrlService.getStateParamFromCurrentUrl(t);if(r){let c=this.getConfigurationWithUrlState(e,r);return c?this.composeMultipleLoginResults(e,c,t):v(()=>new Error(`could not find matching config for state ${r}`))}let n=e,a=n.map(c=>this.checkAuthWithConfig(c,n,t));return me(a)}checkAuthIncludingServer(e,t){return e?this.checkAuthWithConfig(e,t).pipe(I(r=>{let{isAuthenticated:n}=r;return n?p(r):this.refreshSessionService.forceRefreshSession(e,t).pipe(x(a=>{a?.isAuthenticated&&this.startCheckSessionAndValidation(e,t)}))})):v(()=>new Error("Please provide a configuration before setting up the module"))}getConfig(e,t){let r=this.currentUrlService.getStateParamFromCurrentUrl(t);return r?this.getConfigurationWithUrlState([e],r):e}checkAuthWithConfig(e,t,r){if(!e){let u="Please provide at least one configuration before setting up the module";return this.loggerService.logError(e,u),p({isAuthenticated:!1,errorMessage:u,userData:null,idToken:"",accessToken:"",configId:""})}let n=r||this.currentUrlService.getCurrentUrl();if(!n){let u="No URL found!";return this.loggerService.logError(e,u),p({isAuthenticated:!1,errorMessage:u,userData:null,idToken:"",accessToken:"",configId:""})}let{configId:a,authority:c}=e;if(this.loggerService.logDebug(e,`Working with config '${a}' using '${c}'`),this.popupService.isCurrentlyInPopup(e))return this.popupService.sendMessageToMainWindow(n,e),p({isAuthenticated:!1,errorMessage:"",userData:null,idToken:"",accessToken:"",configId:""});let h=this.callbackService.isCallback(n,e);return this.loggerService.logDebug(e,`currentUrl to check auth with: '${n}'`),(h?this.callbackService.handleCallbackAndFireEvents(n,e,t):p({})).pipe(b(()=>{let u=this.authStateService.areAuthStorageTokensValid(e);return this.loggerService.logDebug(e,`checkAuth completed. Firing events now. isAuthenticated: ${u}`),u&&(this.startCheckSessionAndValidation(e,t),h||(this.authStateService.setAuthenticatedAndFireEvent(t),this.userService.publishUserDataIfExists(e,t))),this.publicEventsService.fireEvent(F.CheckingAuthFinished),{isAuthenticated:u,userData:this.userService.getUserDataFromStore(e),accessToken:this.authStateService.getAccessToken(e),idToken:this.authStateService.getIdToken(e),configId:a}}),x(({isAuthenticated:u})=>{u&&this.autoLoginService.checkSavedRedirectRouteAndNavigate(e)}),A(({message:u})=>(this.loggerService.logError(e,u),this.publicEventsService.fireEvent(F.CheckingAuthFinishedWithError,u),p({isAuthenticated:!1,errorMessage:u,userData:null,idToken:"",accessToken:"",configId:a}))))}startCheckSessionAndValidation(e,t){this.checkSessionService.isCheckSessionConfigured(e)&&this.checkSessionService.start(e),this.periodicallyTokenCheckService.startTokenValidationPeriodically(t,e),this.silentRenewService.isSilentRenewConfigured(e)&&this.silentRenewService.getOrCreateIframe(e)}getConfigurationWithUrlState(e,t){if(!t)return null;for(let r of e)if(this.storagePersistenceService.read("authStateControl",r)===t)return r;return null}composeMultipleLoginResults(e,t,r){let n=e.filter(h=>h.configId!==t.configId),a=this.checkAuthWithConfig(t,e,r),c=n.map(h=>{let{redirectUrl:d}=h;return this.checkAuthWithConfig(h,e,d)});return me([a,...c])}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),di=(()=>{let i=class i{constructor(){this.document=l(C)}redirectTo(e){this.document.location.href=e}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),ui=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.flowHelper=l(se)}hasConfigValidResponseType(e){return this.flowHelper.isCurrentFlowAnyImplicitFlow(e)||this.flowHelper.isCurrentFlowCodeFlow(e)?!0:(this.loggerService.logWarning(e,"module configured incorrectly, invalid response_type. Check the responseType in the config"),!1)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Dn=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.urlService=l(G),this.dataService=l(pe),this.storagePersistenceService=l(P)}postParRequest(e,t){let r=new be;r=r.set("Content-Type","application/x-www-form-urlencoded");let n=this.storagePersistenceService.read("authWellKnownEndPoints",e);if(!n)return v(()=>new Error("Could not read PAR endpoint because authWellKnownEndPoints are not given"));let a=n.parEndpoint;return a?this.urlService.createBodyForParCodeFlowRequest(e,t).pipe(I(c=>this.dataService.post(a,c,e,r).pipe(Se(2),b(h=>(this.loggerService.logDebug(e,"par response: ",h),{expiresIn:h.expires_in,requestUri:h.request_uri})),A(h=>{let d="There was an error on ParService postParRequest";return this.loggerService.logError(e,d,h),v(()=>new Error(d))})))):v(()=>new Error("Could not read PAR endpoint from authWellKnownEndpoints"))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),In=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.responseTypeValidationService=l(ui),this.urlService=l(G),this.redirectService=l(di),this.authWellKnownService=l(De),this.popupService=l(yt),this.checkAuthService=l(hi),this.parService=l(Dn)}loginPar(e,t){if(!this.responseTypeValidationService.hasConfigValidResponseType(e)){this.loggerService.logError(e,"Invalid response type!");return}this.loggerService.logDebug(e,"BEGIN Authorize OIDC Flow, no auth data"),this.authWellKnownService.queryAndStoreAuthWellKnownEndPoints(e).pipe(I(()=>this.parService.postParRequest(e,t))).subscribe(r=>{this.loggerService.logDebug(e,"par response: ",r);let n=this.urlService.getAuthorizeParUrl(r.requestUri,e);if(this.loggerService.logDebug(e,"par request url: ",n),!n){this.loggerService.logError(e,`Could not create URL with param ${r.requestUri}: '${n}'`);return}t?.urlHandler?t.urlHandler(n):this.redirectService.redirectTo(n)})}loginWithPopUpPar(e,t,r,n){let{configId:a}=e;if(!this.responseTypeValidationService.hasConfigValidResponseType(e)){let c="Invalid response type!";return this.loggerService.logError(e,c),v(()=>new Error(c))}return this.loggerService.logDebug(e,"BEGIN Authorize OIDC Flow with popup, no auth data"),this.authWellKnownService.queryAndStoreAuthWellKnownEndPoints(e).pipe(I(()=>this.parService.postParRequest(e,r)),I(c=>{this.loggerService.logDebug(e,`par response: ${c}`);let h=this.urlService.getAuthorizeParUrl(c.requestUri,e);if(this.loggerService.logDebug(e,"par request url: ",h),!h){let d=`Could not create URL with param ${c.requestUri}: 'url'`;return this.loggerService.logError(e,d),v(()=>new Error(d))}return this.popupService.openPopUp(h,n,e),this.popupService.result$.pipe(xe(1),I(d=>{let{userClosed:u,receivedUrl:g}=d;return u?p({isAuthenticated:!1,errorMessage:"User closed popup",userData:null,idToken:"",accessToken:"",configId:a}):this.checkAuthService.checkAuth(e,t,g)}))}))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),En=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.responseTypeValidationService=l(ui),this.urlService=l(G),this.authWellKnownService=l(De),this.popupService=l(yt),this.checkAuthService=l(hi)}loginWithPopUpStandard(e,t,r,n){let{configId:a}=e;if(!this.responseTypeValidationService.hasConfigValidResponseType(e)){let c="Invalid response type!";return this.loggerService.logError(e,c),v(()=>new Error(c))}return this.loggerService.logDebug(e,"BEGIN Authorize OIDC Flow with popup, no auth data"),this.authWellKnownService.queryAndStoreAuthWellKnownEndPoints(e).pipe(I(()=>this.urlService.getAuthorizeUrl(e,r)),x(c=>this.popupService.openPopUp(c,n,e)),I(()=>this.popupService.result$.pipe(xe(1),I(c=>{let{userClosed:h,receivedUrl:d}=c;return h?p({isAuthenticated:!1,errorMessage:"User closed popup",userData:null,idToken:"",accessToken:"",configId:a}):this.checkAuthService.checkAuth(e,t,d)}))))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Pn=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.responseTypeValidationService=l(ui),this.urlService=l(G),this.redirectService=l(di),this.authWellKnownService=l(De),this.flowsDataService=l(U)}loginStandard(e,t){if(!this.responseTypeValidationService.hasConfigValidResponseType(e)){this.loggerService.logError(e,"Invalid response type!");return}this.loggerService.logDebug(e,"BEGIN Authorize OIDC Flow, no auth data"),this.flowsDataService.setCodeFlowInProgress(e),this.authWellKnownService.queryAndStoreAuthWellKnownEndPoints(e).subscribe(()=>{let{urlHandler:r}=t||{};this.flowsDataService.resetSilentRenewRunning(e),this.urlService.getAuthorizeUrl(e,t).subscribe(n=>{if(!n){this.loggerService.logError(e,"Could not create URL",n);return}r?r(n):this.redirectService.redirectTo(n)})})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),An=(()=>{let i=class i{constructor(){this.parLoginService=l(In),this.popUpLoginService=l(En),this.standardLoginService=l(Pn),this.storagePersistenceService=l(P),this.popupService=l(yt)}login(e,t){if(!e)throw new Error("Please provide a configuration before setting up the module");let{usePushedAuthorisationRequests:r}=e;return t?.customParams&&this.storagePersistenceService.write("storageCustomParamsAuthRequest",t.customParams,e),r?this.parLoginService.loginPar(e,t):this.standardLoginService.loginStandard(e,t)}loginWithPopUp(e,t,r,n){if(!e)throw new Error("Please provide a configuration before setting up the module");if(this.popupService.isCurrentlyInPopup(e))return p({errorMessage:"There is already a popup open."});let{usePushedAuthorisationRequests:c}=e;return r?.customParams&&this.storagePersistenceService.write("storageCustomParamsAuthRequest",r.customParams,e),c?this.parLoginService.loginWithPopUpPar(e,t,r,n):this.popUpLoginService.loginWithPopUpStandard(e,t,r,n)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();function Tn(s){let i=y({},s);for(let o in s)(s[o]===void 0||s[o]===null)&&delete i[o];return i}var On=(()=>{let i=class i{constructor(){this.loggerService=l(_),this.dataService=l(pe),this.storagePersistenceService=l(P),this.urlService=l(G),this.checkSessionService=l(ci),this.resetAuthDataService=l(ne),this.redirectService=l(di)}logoff(e,t,r){if(!e)return v(()=>new Error("Please provide a configuration before setting up the module"));this.loggerService.logDebug(e,"logoff, remove auth",r);let{urlHandler:n,customParams:a}=r||{},c=this.urlService.getEndSessionUrl(e,a);return c?this.checkSessionService.serverStateChanged(e)?(this.loggerService.logDebug(e,"Server State changed. Logoff was only locally. Returning."),p(null)):n?(this.loggerService.logDebug(e,`Custom UrlHandler found. Using this to handle logoff with url '${c}'`),n(c),this.resetAuthDataService.resetAuthorizationData(e,t),p(null)):this.logoffInternal(r,c,e,t):(this.loggerService.logDebug(e,"No endsessionUrl present. Logoff was only locally. Returning."),p(null))}logoffLocal(e,t){this.resetAuthDataService.resetAuthorizationData(e,t),this.checkSessionService.stop()}logoffLocalMultiple(e){e.forEach(t=>this.logoffLocal(t,e))}logoffAndRevokeTokens(e,t,r){if(!e)return v(()=>new Error("Please provide a configuration before setting up the module"));let{revocationEndpoint:n}=this.storagePersistenceService.read("authWellKnownEndPoints",e)||{};return n?this.storagePersistenceService.getRefreshToken(e)?this.revokeRefreshToken(e).pipe(I(a=>this.revokeAccessToken(e)),A(a=>{let c="revoke token failed";return this.loggerService.logError(e,c,a),v(()=>new Error(c))}),k(()=>this.logoff(e,t,r))):this.revokeAccessToken(e).pipe(A(a=>{let c="revoke accessToken failed";return this.loggerService.logError(e,c,a),v(()=>new Error(c))}),k(()=>this.logoff(e,t,r))):(this.loggerService.logDebug(e,"revocation endpoint not supported"),this.logoff(e,t,r))}revokeAccessToken(e,t){if(!e)return v(()=>new Error("Please provide a configuration before setting up the module"));let r=t||this.storagePersistenceService.getAccessToken(e),n=this.urlService.createRevocationEndpointBodyAccessToken(r,e);return this.sendRevokeRequest(e,n)}revokeRefreshToken(e,t){if(!e)return v(()=>new Error("Please provide a configuration before setting up the module"));let r=t||this.storagePersistenceService.getRefreshToken(e),n=this.urlService.createRevocationEndpointBodyRefreshToken(r,e);return this.sendRevokeRequest(e,n)}logoffInternal(e,t,r,n){let{logoffMethod:a,customParams:c}=e||{};if(!a||a==="GET")return this.redirectService.redirectTo(t),this.resetAuthDataService.resetAuthorizationData(r,n),p(null);let{state:h,logout_hint:d,ui_locales:u}=c||{},{clientId:g}=r,S=this.storagePersistenceService.getIdToken(r),w=this.urlService.getPostLogoutRedirectUrl(r),m=this.getHeaders(),{url:X}=this.urlService.getEndSessionEndpoint(r),oe=Tn({id_token_hint:S,client_id:g,post_logout_redirect_uri:w,state:h,logout_hint:d,ui_locales:u});return this.resetAuthDataService.resetAuthorizationData(r,n),this.dataService.post(X,oe,r,m)}sendRevokeRequest(e,t){let r=this.urlService.getRevocationEndpointUrl(e),n=this.getHeaders();return this.dataService.post(r,t,e,n).pipe(Se(2),I(a=>(this.loggerService.logDebug(e,"revocation endpoint post response: ",a),p(a))),A(a=>{let c="Revocation request failed";return this.loggerService.logError(e,c,a),v(()=>new Error(c))}))}getHeaders(){let e=new be;return e=e.set("Content-Type","application/x-www-form-urlencoded"),e}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),zr=(()=>{let i=class i{constructor(){this.checkSessionService=l(ci),this.checkAuthService=l(hi),this.userService=l(Ce),this.tokenHelperService=l(vt),this.configurationService=l(ai),this.authStateService=l(Y),this.flowsDataService=l(U),this.callbackService=l(Wr),this.logoffRevocationService=l(On),this.loginService=l(An),this.refreshSessionService=l(Br),this.urlService=l(G),this.authWellKnownService=l(De),this.userData=Be(this.userData$,{requireSync:!0}),this.authenticated=Be(this.isAuthenticated$,{requireSync:!0})}get userData$(){return this.userService.userData$}get isAuthenticated$(){return this.authStateService.authenticated$}get checkSessionChanged$(){return this.checkSessionService.checkSessionChanged$}get stsCallback$(){return this.callbackService.stsCallback$}preloadAuthWellKnownDocument(e){return this.configurationService.getOpenIDConfiguration(e).pipe(k(t=>this.authWellKnownService.queryAndStoreAuthWellKnownEndPoints(t)))}getConfigurations(){return this.configurationService.getAllConfigurations()}getConfiguration(e){return this.configurationService.getOpenIDConfiguration(e)}getUserData(e){return this.configurationService.getOpenIDConfiguration(e).pipe(b(t=>this.userService.getUserDataFromStore(t)))}checkAuth(e,t){return this.configurationService.getOpenIDConfigurations(t).pipe(k(({allConfigs:r,currentConfig:n})=>this.checkAuthService.checkAuth(n,r,e)))}checkAuthMultiple(e){return this.configurationService.getOpenIDConfigurations().pipe(k(({allConfigs:t})=>this.checkAuthService.checkAuthMultiple(t,e)))}isAuthenticated(e){return this.configurationService.getOpenIDConfiguration(e).pipe(b(t=>this.authStateService.isAuthenticated(t)))}checkAuthIncludingServer(e){return this.configurationService.getOpenIDConfigurations(e).pipe(k(({allConfigs:t,currentConfig:r})=>this.checkAuthService.checkAuthIncludingServer(r,t)))}getAccessToken(e){return this.configurationService.getOpenIDConfiguration(e).pipe(b(t=>this.authStateService.getAccessToken(t)))}getIdToken(e){return this.configurationService.getOpenIDConfiguration(e).pipe(b(t=>this.authStateService.getIdToken(t)))}getRefreshToken(e){return this.configurationService.getOpenIDConfiguration(e).pipe(b(t=>this.authStateService.getRefreshToken(t)))}getAuthenticationResult(e){return this.configurationService.getOpenIDConfiguration(e).pipe(b(t=>this.authStateService.getAuthenticationResult(t)))}getPayloadFromIdToken(e=!1,t){return this.configurationService.getOpenIDConfiguration(t).pipe(b(r=>{let n=this.authStateService.getIdToken(r);return this.tokenHelperService.getPayloadFromToken(n,e,r)}))}getPayloadFromAccessToken(e=!1,t){return this.configurationService.getOpenIDConfiguration(t).pipe(b(r=>{let n=this.authStateService.getAccessToken(r);return this.tokenHelperService.getPayloadFromToken(n,e,r)}))}setState(e,t){return this.configurationService.getOpenIDConfiguration(t).pipe(b(r=>this.flowsDataService.setAuthStateControl(e,r)))}getState(e){return this.configurationService.getOpenIDConfiguration(e).pipe(b(t=>this.flowsDataService.getAuthStateControl(t)))}authorize(e,t){this.configurationService.getOpenIDConfiguration(e).subscribe(r=>this.loginService.login(r,t))}authorizeWithPopUp(e,t,r){return this.configurationService.getOpenIDConfigurations(r).pipe(k(({allConfigs:n,currentConfig:a})=>this.loginService.loginWithPopUp(a,n,e,t)))}forceRefreshSession(e,t){return this.configurationService.getOpenIDConfigurations(t).pipe(k(({allConfigs:r,currentConfig:n})=>this.refreshSessionService.userForceRefreshSession(n,r,e)))}logoffAndRevokeTokens(e,t){return this.configurationService.getOpenIDConfigurations(e).pipe(k(({allConfigs:r,currentConfig:n})=>this.logoffRevocationService.logoffAndRevokeTokens(n,r,t)))}logoff(e,t){return this.configurationService.getOpenIDConfigurations(e).pipe(k(({allConfigs:r,currentConfig:n})=>this.logoffRevocationService.logoff(n,r,t)))}logoffLocal(e){this.configurationService.getOpenIDConfigurations(e).subscribe(({allConfigs:t,currentConfig:r})=>this.logoffRevocationService.logoffLocal(r,t))}logoffLocalMultiple(){this.configurationService.getOpenIDConfigurations().subscribe(({allConfigs:e})=>this.logoffRevocationService.logoffLocalMultiple(e))}revokeAccessToken(e,t){return this.configurationService.getOpenIDConfiguration(t).pipe(k(r=>this.logoffRevocationService.revokeAccessToken(r,e)))}revokeRefreshToken(e,t){return this.configurationService.getOpenIDConfiguration(t).pipe(k(r=>this.logoffRevocationService.revokeRefreshToken(r,e)))}getEndSessionUrl(e,t){return this.configurationService.getOpenIDConfiguration(t).pipe(b(r=>this.urlService.getEndSessionUrl(r,e)))}getAuthorizeUrl(e,t){return this.configurationService.getOpenIDConfiguration(t).pipe(k(r=>this.urlService.getAuthorizeUrl(r,e?{customParams:e}:void 0)))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),xn=(()=>{let i=class i{read(e){return sessionStorage.getItem(e)}write(e,t){sessionStorage.setItem(e,t)}remove(e){sessionStorage.removeItem(e)}clear(){sessionStorage.clear()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();function jr(s,...i){let o=Mn(s);for(let e of i)o.push(...e.\u0275providers);return Pi(o)}function Mn(s){return[{provide:Dr,useValue:s},s?.loader||{provide:pt,useFactory:Os,deps:[Dr]},{provide:Or,useClass:xn},{provide:Tr,useClass:xs}]}function $r(s){return s.reduce((i,o)=>i.concat(Array.isArray(o)?$r(o):o),[])}function Fn(s){let i=Un(s);return new RegExp(`^${i}$`)}function Un(s){return s.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*")}var Wn=(()=>{let i=class i{getConfigIdForClosestMatchingRoute(e,t){for(let r of t){let{secureRoutes:n}=r,a=(n??[]).find(c=>this.routeMatches(c,e));if(a)return{matchingRoute:a,matchingConfig:r}}return{matchingRoute:null,matchingConfig:null}}routeMatches(e,t){return t.startsWith(e)||this.matchesRoute(e,t)}matchesRoute(e,t){return Fn(e).test(t)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();function Kr(){return(s,i)=>Vn(s,i,{configurationService:l(ai),authStateService:l(Y),closestMatchingRouteService:l(Wn),loggerService:l(_)})}function Vn(s,i,o){if(!o.configurationService.hasAtLeastOneConfig())return i(s);let e=o.configurationService.getAllConfigurations(),t=e.map(h=>h.secureRoutes||[]);if($r(t).length===0)return o.loggerService.logDebug(e[0],"No routes to check configured"),i(s);let{matchingConfig:n,matchingRoute:a}=o.closestMatchingRouteService.getConfigIdForClosestMatchingRoute(s.url,e);if(!n)return o.loggerService.logDebug(e[0],`Did not find any configured route for route ${s.url}`),i(s);o.loggerService.logDebug(n,`'${s.url}' matches configured route '${a}'`);let c=o.authStateService.getAccessToken(n);return c?(o.loggerService.logDebug(n,`'${s.url}' matches configured route '${a}', adding token`),s=s.clone({headers:s.headers.set("Authorization","Bearer "+c)}),i(s)):(o.loggerService.logDebug(n,`Wanted to add token to ${s.url} but found no token: '${c}'`),i(s))}var _t=[];function Yr(){let s={};for(let i of _t)s[i.name]=i.signal();return s}function Ln(){let s="";return{attachState(i,o){let e=o?.name??`signal_${_t.length}`;if(_t.some(r=>r.signal===i))return;_t.push({name:e,signal:i});let t=Yr();s=JSON.stringify(t),console.log(`${e}/INIT`,t),Kt(()=>{let r=Yr(),n=JSON.stringify(r);n!==s&&(s=n,console.log("STORE_UPDATE",r))})}}}var wt=Ln();var Nn={isAuthenticated:!1},Ee=class s{#e=l(zr);#t=Be(this.#e.checkAuth(),{initialValue:Nn});isAuthenticated=$(()=>this.#t().isAuthenticated);userData=$(()=>this.#t().userData);auth=$(()=>this.#t());token=$(()=>this.#t().accessToken);roles=$(()=>{let i=this.token();return i?JSON.parse(atob(i?.split(".")[1]))?.realm_access?.roles||[]:null});constructor(){wt.attachState(this.auth,{name:"AuthStore"})}login(){this.#e.authorize()}logout(){return Qe(this.#e.logoff())}static \u0275fac=function(o){return new(o||s)};static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})};var Hn=()=>Oe(null,null,function*(){let s=l(dt);return yield Qe(s.getBlogPosts())}),Bn=()=>Oe(null,null,function*(){let s=l(Ee),i=yield s.roles();return console.log("User Roles from Auth Guard",i),s.isAuthenticated()&&i?.includes("user")?!0:(s.login(),!1)}),Xr=[{path:"",redirectTo:"overview",pathMatch:"full"},{path:"demo",loadComponent:()=>import("./chunk-4GIWFTJ3.js")},{path:"overview",loadComponent:()=>import("./chunk-IJBOZ7I6.js"),resolve:{model:Hn},runGuardsAndResolvers:"always"},{path:"detail/:id",loadComponent:()=>import("./chunk-ZJBFBWOO.js")},{path:"add-blog",loadComponent:()=>import("./chunk-67GXKJ2G.js"),canActivate:[Bn]},...wr,...kr];var qr=(s,i)=>(console.log("Request",s),i(s).pipe(x(o=>console.log("Response",o))));var zn=[qr],Gr=zn;var Zr={config:{authority:"https://d-cap-keyclaok.kindbay-711f60b2.westeurope.azurecontainerapps.io/realms/blog",redirectUrl:window.location.origin,postLogoutRedirectUri:window.location.origin,clientId:"spa-blog",scope:"openid profile email offline_access",responseType:"code",silentRenew:!0,silentRenewUrl:window.location.origin+"/silent-renew.html",renewTimeBeforeTokenExpiresInSeconds:10,secureRoutes:[ue.serviceUrl]}};var Jr={providers:[Ti(),Ni({eventCoalescing:!0}),rr(Xr,sr()),qt(Gi(),qi([...Gr,Kr()])),_r(),jr(Zr)]};var jn={isLoading:!1},bt=class s{#e=l(ke);dispatcher=l(yr);#t=Lt(jn);isLoading=$(()=>this.#t().isLoading);constructor(){wt.attachState(this.#t,{name:"RouterStore"}),this.#e.events.subscribe(i=>{switch(!0){case i instanceof Zi:{this.#i(!0);break}case i instanceof Ji:case i instanceof Qi:case i instanceof er:{this.#i(!1);break}}}),this.dispatcher.action$.pipe(ee(i=>i.type==="SET_LOADING_STATE")).subscribe(i=>{this.#i(i.payload.isLoading)})}#i(i){this.#t.update(o=>ae(y({},o),{isLoading:i}))}static \u0275fac=function(o){return new(o||s)};static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})};var $n=["*",[["mat-toolbar-row"]]],Kn=["*","mat-toolbar-row"],Yn=(()=>{class s{static \u0275fac=function(e){return new(e||s)};static \u0275dir=he({type:s,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]})}return s})(),Qr=(()=>{class s{_elementRef=l(j);_platform=l(K);_document=l(C);color;_toolbarRows;constructor(){}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=V({type:s,selectors:[["mat-toolbar"]],contentQueries:function(e,t,r){if(e&1&&Ui(r,Yn,5),e&2){let n;Ne(n=He())&&(t._toolbarRows=n)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(e,t){e&2&&(Wi(t.color?"mat-"+t.color:""),we("mat-toolbar-multiple-rows",t._toolbarRows.length>0)("mat-toolbar-single-row",t._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],ngContentSelectors:Kn,decls:2,vars:0,template:function(e,t){e&1&&(jt($n),nt(0),nt(1,1))},styles:[`.mat-toolbar{background:var(--mat-toolbar-container-background-color, var(--mat-sys-surface));color:var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface))}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font, var(--mat-sys-title-large-font));font-size:var(--mat-toolbar-title-text-size, var(--mat-sys-title-large-size));line-height:var(--mat-toolbar-title-text-line-height, var(--mat-sys-title-large-line-height));font-weight:var(--mat-toolbar-title-text-weight, var(--mat-sys-title-large-weight));letter-spacing:var(--mat-toolbar-title-text-tracking, var(--mat-sys-title-large-tracking));margin:0}@media(forced-colors: active){.mat-toolbar{outline:solid 1px}}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mat-button-text-label-text-color: var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface));--mat-button-outlined-label-text-color: var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface))}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height, 64px)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height, 56px)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height, 64px)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height, 56px)}}
`],encapsulation:2,changeDetection:0})}return s})();var es=(()=>{class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=H({type:s});static \u0275inj=N({imports:[Re,Re]})}return s})();var Qn=20,Pe=(()=>{class s{_ngZone=l(M);_platform=l(K);_renderer=l(J).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new T;_scrolledCount=0;scrollContainers=new Map;register(o){this.scrollContainers.has(o)||this.scrollContainers.set(o,o.elementScrolled().subscribe(()=>this._scrolled.next(o)))}deregister(o){let e=this.scrollContainers.get(o);e&&(e.unsubscribe(),this.scrollContainers.delete(o))}scrolled(o=Qn){return this._platform.isBrowser?new le(e=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let t=o>0?this._scrolled.pipe(Wt(o)).subscribe(e):this._scrolled.subscribe(e);return this._scrolledCount++,()=>{t.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):p()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((o,e)=>this.deregister(e)),this._scrolled.complete()}ancestorScrolled(o,e){let t=this.getAncestorScrollContainers(o);return this.scrolled(e).pipe(ee(r=>!r||t.indexOf(r)>-1))}getAncestorScrollContainers(o){let e=[];return this.scrollContainers.forEach((t,r)=>{this._scrollableContainsElement(r,o)&&e.push(r)}),e}_scrollableContainsElement(o,e){let t=or(e),r=o.getElementRef().nativeElement;do if(t==r)return!0;while(t=t.parentElement);return!1}static \u0275fac=function(e){return new(e||s)};static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var eo=20,Ae=(()=>{class s{_platform=l(K);_listeners;_viewportSize;_change=new T;_document=l(C);constructor(){let o=l(M),e=l(J).createRenderer(null,null);o.runOutsideAngular(()=>{if(this._platform.isBrowser){let t=r=>this._change.next(r);this._listeners=[e.listen("window","resize",t),e.listen("window","orientationchange",t)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(o=>o()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let o={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),o}getViewportRect(){let o=this.getViewportScrollPosition(),{width:e,height:t}=this.getViewportSize();return{top:o.top,left:o.left,bottom:o.top+t,right:o.left+e,height:t,width:e}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let o=this._document,e=this._getWindow(),t=o.documentElement,r=t.getBoundingClientRect(),n=-r.top||o.body.scrollTop||e.scrollY||t.scrollTop||0,a=-r.left||o.body.scrollLeft||e.scrollX||t.scrollLeft||0;return{top:n,left:a}}change(o=eo){return o>0?this._change.pipe(Wt(o)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let o=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:o.innerWidth,height:o.innerHeight}:{width:0,height:0}}static \u0275fac=function(e){return new(e||s)};static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var Ke=(()=>{class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=H({type:s});static \u0275inj=N({})}return s})(),fi=(()=>{class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=H({type:s});static \u0275inj=N({imports:[ze,Ke,ze,Ke]})}return s})();var Ye=class{_attachedHost;attach(i){return this._attachedHost=i,i.attach(this)}detach(){let i=this._attachedHost;i!=null&&(this._attachedHost=null,i.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(i){this._attachedHost=i}},Xe=class extends Ye{component;viewContainerRef;injector;projectableNodes;constructor(i,o,e,t){super(),this.component=i,this.viewContainerRef=o,this.injector=e,this.projectableNodes=t}},kt=class extends Ye{templateRef;viewContainerRef;context;injector;constructor(i,o,e,t){super(),this.templateRef=i,this.viewContainerRef=o,this.context=e,this.injector=t}get origin(){return this.templateRef.elementRef}attach(i,o=this.context){return this.context=o,super.attach(i)}detach(){return this.context=void 0,super.detach()}},pi=class extends Ye{element;constructor(i){super(),this.element=i instanceof j?i.nativeElement:i}},gi=class{_attachedPortal;_disposeFn;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(i){if(i instanceof Xe)return this._attachedPortal=i,this.attachComponentPortal(i);if(i instanceof kt)return this._attachedPortal=i,this.attachTemplatePortal(i);if(this.attachDomPortal&&i instanceof pi)return this._attachedPortal=i,this.attachDomPortal(i)}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(i){this._disposeFn=i}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}},Rt=class extends gi{outletElement;_appRef;_defaultInjector;constructor(i,o,e){super(),this.outletElement=i,this._appRef=o,this._defaultInjector=e}attachComponentPortal(i){let o;if(i.viewContainerRef){let e=i.injector||i.viewContainerRef.injector,t=e.get(Fi,null,{optional:!0})||void 0;o=i.viewContainerRef.createComponent(i.component,{index:i.viewContainerRef.length,injector:e,ngModuleRef:t,projectableNodes:i.projectableNodes||void 0}),this.setDisposeFn(()=>o.destroy())}else{let e=this._appRef,t=i.injector||this._defaultInjector||W.NULL,r=t.get(it,e.injector);o=Bi(i.component,{elementInjector:t,environmentInjector:r,projectableNodes:i.projectableNodes||void 0}),e.attachView(o.hostView),this.setDisposeFn(()=>{e.viewCount>0&&e.detachView(o.hostView),o.destroy()})}return this.outletElement.appendChild(this._getComponentRootNode(o)),this._attachedPortal=i,o}attachTemplatePortal(i){let o=i.viewContainerRef,e=o.createEmbeddedView(i.templateRef,i.context,{injector:i.injector});return e.rootNodes.forEach(t=>this.outletElement.appendChild(t)),e.detectChanges(),this.setDisposeFn(()=>{let t=o.indexOf(e);t!==-1&&o.remove(t)}),this._attachedPortal=i,e}attachDomPortal=i=>{let o=i.element;o.parentNode;let e=this.outletElement.ownerDocument.createComment("dom-portal");o.parentNode.insertBefore(e,o),this.outletElement.appendChild(o),this._attachedPortal=i,super.setDisposeFn(()=>{e.parentNode&&e.parentNode.replaceChild(o,e)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(i){return i.hostView.rootNodes[0]}};var is=(()=>{class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=H({type:s});static \u0275inj=N({})}return s})();var rs=fr();function hs(s){return new Ct(s.get(Ae),s.get(C))}var Ct=class{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(i,o){this._viewportRuler=i,this._document=o}attach(){}enable(){if(this._canBeEnabled()){let i=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=i.style.left||"",this._previousHTMLStyles.top=i.style.top||"",i.style.left=E(-this._previousScrollPosition.left),i.style.top=E(-this._previousScrollPosition.top),i.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let i=this._document.documentElement,o=this._document.body,e=i.style,t=o.style,r=e.scrollBehavior||"",n=t.scrollBehavior||"";this._isEnabled=!1,e.left=this._previousHTMLStyles.left,e.top=this._previousHTMLStyles.top,i.classList.remove("cdk-global-scrollblock"),rs&&(e.scrollBehavior=t.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),rs&&(e.scrollBehavior=r,t.scrollBehavior=n)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let o=this._document.documentElement,e=this._viewportRuler.getViewportSize();return o.scrollHeight>e.height||o.scrollWidth>e.width}};function ds(s,i){return new Dt(s.get(Pe),s.get(M),s.get(Ae),i)}var Dt=class{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(i,o,e,t){this._scrollDispatcher=i,this._ngZone=o,this._viewportRuler=e,this._config=t}attach(i){this._overlayRef,this._overlayRef=i}enable(){if(this._scrollSubscription)return;let i=this._scrollDispatcher.scrolled(0).pipe(ee(o=>!o||!this._overlayRef.overlayElement.contains(o.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=i.subscribe(()=>{let o=this._viewportRuler.getViewportScrollPosition().top;Math.abs(o-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=i.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}};var qe=class{enable(){}disable(){}attach(){}};function vi(s,i){return i.some(o=>{let e=s.bottom<o.top,t=s.top>o.bottom,r=s.right<o.left,n=s.left>o.right;return e||t||r||n})}function ss(s,i){return i.some(o=>{let e=s.top<o.top,t=s.bottom>o.bottom,r=s.left<o.left,n=s.right>o.right;return e||t||r||n})}function ve(s,i){return new It(s.get(Pe),s.get(Ae),s.get(M),i)}var It=class{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(i,o,e,t){this._scrollDispatcher=i,this._viewportRuler=o,this._ngZone=e,this._config=t}attach(i){this._overlayRef,this._overlayRef=i}enable(){if(!this._scrollSubscription){let i=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(i).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let o=this._overlayRef.overlayElement.getBoundingClientRect(),{width:e,height:t}=this._viewportRuler.getViewportSize();vi(o,[{width:e,height:t,bottom:t,right:e,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},us=(()=>{class s{_injector=l(W);constructor(){}noop=()=>new qe;close=o=>ds(this._injector,o);block=()=>hs(this._injector);reposition=o=>ve(this._injector,o);static \u0275fac=function(e){return new(e||s)};static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),Et=class{positionStrategy;scrollStrategy=new qe;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";disableAnimations;width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;constructor(i){if(i){let o=Object.keys(i);for(let e of o)i[e]!==void 0&&(this[e]=i[e])}}};var Pt=class{connectionPair;scrollableViewProperties;constructor(i,o){this.connectionPair=i,this.scrollableViewProperties=o}};var fs=(()=>{class s{_attachedOverlays=[];_document=l(C);_isAttached;constructor(){}ngOnDestroy(){this.detach()}add(o){this.remove(o),this._attachedOverlays.push(o)}remove(o){let e=this._attachedOverlays.indexOf(o);e>-1&&this._attachedOverlays.splice(e,1),this._attachedOverlays.length===0&&this.detach()}static \u0275fac=function(e){return new(e||s)};static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),ps=(()=>{class s extends fs{_ngZone=l(M);_renderer=l(J).createRenderer(null,null);_cleanupKeydown;add(o){super.add(o),this._isAttached||(this._ngZone.runOutsideAngular(()=>{this._cleanupKeydown=this._renderer.listen("body","keydown",this._keydownListener)}),this._isAttached=!0)}detach(){this._isAttached&&(this._cleanupKeydown?.(),this._isAttached=!1)}_keydownListener=o=>{let e=this._attachedOverlays;for(let t=e.length-1;t>-1;t--)if(e[t]._keydownEvents.observers.length>0){this._ngZone.run(()=>e[t]._keydownEvents.next(o));break}};static \u0275fac=(()=>{let o;return function(t){return(o||(o=rt(s)))(t||s)}})();static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),gs=(()=>{class s extends fs{_platform=l(K);_ngZone=l(M);_renderer=l(J).createRenderer(null,null);_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget;_cleanups;add(o){if(super.add(o),!this._isAttached){let e=this._document.body,t={capture:!0},r=this._renderer;this._cleanups=this._ngZone.runOutsideAngular(()=>[r.listen(e,"pointerdown",this._pointerDownListener,t),r.listen(e,"click",this._clickListener,t),r.listen(e,"auxclick",this._clickListener,t),r.listen(e,"contextmenu",this._clickListener,t)]),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=e.style.cursor,e.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){this._isAttached&&(this._cleanups?.forEach(o=>o()),this._cleanups=void 0,this._platform.IOS&&this._cursorStyleIsSet&&(this._document.body.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1)}_pointerDownListener=o=>{this._pointerDownEventTarget=Jt(o)};_clickListener=o=>{let e=Jt(o),t=o.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:e;this._pointerDownEventTarget=null;let r=this._attachedOverlays.slice();for(let n=r.length-1;n>-1;n--){let a=r[n];if(a._outsidePointerEvents.observers.length<1||!a.hasAttached())continue;if(ns(a.overlayElement,e)||ns(a.overlayElement,t))break;let c=a._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>c.next(o)):c.next(o)}};static \u0275fac=(()=>{let o;return function(t){return(o||(o=rt(s)))(t||s)}})();static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();function ns(s,i){let o=typeof ShadowRoot<"u"&&ShadowRoot,e=i;for(;e;){if(e===s)return!0;e=o&&e instanceof ShadowRoot?e.host:e.parentNode}return!1}var vs=(()=>{class s{static \u0275fac=function(e){return new(e||s)};static \u0275cmp=V({type:s,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(e,t){},styles:[`.cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0;touch-action:manipulation}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}@media(prefers-reduced-motion){.cdk-overlay-backdrop{transition-duration:1ms}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}
`],encapsulation:2,changeDetection:0})}return s})(),ms=(()=>{class s{_platform=l(K);_containerElement;_document=l(C);_styleLoader=l(Qt);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let o="cdk-overlay-container";if(this._platform.isBrowser||ei()){let t=this._document.querySelectorAll(`.${o}[platform="server"], .${o}[platform="test"]`);for(let r=0;r<t.length;r++)t[r].remove()}let e=this._document.createElement("div");e.classList.add(o),ei()?e.setAttribute("platform","test"):this._platform.isBrowser||e.setAttribute("platform","server"),this._document.body.appendChild(e),this._containerElement=e}_loadStyles(){this._styleLoader.load(vs)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),mi=class{_renderer;_ngZone;element;_cleanupClick;_cleanupTransitionEnd;_fallbackTimeout;constructor(i,o,e,t){this._renderer=o,this._ngZone=e,this.element=i.createElement("div"),this.element.classList.add("cdk-overlay-backdrop"),this._cleanupClick=o.listen(this.element,"click",t)}detach(){this._ngZone.runOutsideAngular(()=>{let i=this.element;clearTimeout(this._fallbackTimeout),this._cleanupTransitionEnd?.(),this._cleanupTransitionEnd=this._renderer.listen(i,"transitionend",this.dispose),this._fallbackTimeout=setTimeout(this.dispose,500),i.style.pointerEvents="none",i.classList.remove("cdk-overlay-backdrop-showing")})}dispose=()=>{clearTimeout(this._fallbackTimeout),this._cleanupClick?.(),this._cleanupTransitionEnd?.(),this._cleanupClick=this._cleanupTransitionEnd=this._fallbackTimeout=void 0,this.element.remove()}},At=class{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_renderer;_backdropClick=new T;_attachments=new T;_detachments=new T;_positionStrategy;_scrollStrategy;_locationChanges=Ge.EMPTY;_backdropRef=null;_detachContentMutationObserver;_detachContentAfterRenderRef;_previousHostParent;_keydownEvents=new T;_outsidePointerEvents=new T;_afterNextRenderRef;constructor(i,o,e,t,r,n,a,c,h,d=!1,u,g){this._portalOutlet=i,this._host=o,this._pane=e,this._config=t,this._ngZone=r,this._keyboardDispatcher=n,this._document=a,this._location=c,this._outsideClickDispatcher=h,this._animationsDisabled=d,this._injector=u,this._renderer=g,t.scrollStrategy&&(this._scrollStrategy=t.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=t.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropRef?.element||null}get hostElement(){return this._host}attach(i){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let o=this._portalOutlet.attach(i);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=de(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._completeDetachContent(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof o?.onDestroy=="function"&&o.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),o}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let i=this._portalOutlet.detach();return this._detachments.next(),this._completeDetachContent(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),i}dispose(){let i=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._backdropRef?.dispose(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=this._backdropRef=null,i&&this._detachments.next(),this._detachments.complete(),this._completeDetachContent()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(i){i!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=i,this.hasAttached()&&(i.attach(this),this.updatePosition()))}updateSize(i){this._config=y(y({},this._config),i),this._updateElementSize()}setDirection(i){this._config=ae(y({},this._config),{direction:i}),this._updateElementDirection()}addPanelClass(i){this._pane&&this._toggleClasses(this._pane,i,!0)}removePanelClass(i){this._pane&&this._toggleClasses(this._pane,i,!1)}getDirection(){let i=this._config.direction;return i?typeof i=="string"?i:i.value:"ltr"}updateScrollStrategy(i){i!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=i,this.hasAttached()&&(i.attach(this),i.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let i=this._pane.style;i.width=E(this._config.width),i.height=E(this._config.height),i.minWidth=E(this._config.minWidth),i.minHeight=E(this._config.minHeight),i.maxWidth=E(this._config.maxWidth),i.maxHeight=E(this._config.maxHeight)}_togglePointerEvents(i){this._pane.style.pointerEvents=i?"":"none"}_attachBackdrop(){let i="cdk-overlay-backdrop-showing";this._backdropRef?.dispose(),this._backdropRef=new mi(this._document,this._renderer,this._ngZone,o=>{this._backdropClick.next(o)}),this._animationsDisabled&&this._backdropRef.element.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropRef.element,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropRef.element,this._host),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._backdropRef?.element.classList.add(i))}):this._backdropRef.element.classList.add(i)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){this._animationsDisabled?(this._backdropRef?.dispose(),this._backdropRef=null):this._backdropRef?.detach()}_toggleClasses(i,o,e){let t=Gt(o||[]).filter(r=>!!r);t.length&&(e?i.classList.add(...t):i.classList.remove(...t))}_detachContentWhenEmpty(){let i=!1;try{this._detachContentAfterRenderRef=de(()=>{i=!0,this._detachContent()},{injector:this._injector})}catch(o){if(i)throw o;this._detachContent()}globalThis.MutationObserver&&this._pane&&(this._detachContentMutationObserver||=new globalThis.MutationObserver(()=>{this._detachContent()}),this._detachContentMutationObserver.observe(this._pane,{childList:!0}))}_detachContent(){(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),this._completeDetachContent())}_completeDetachContent(){this._detachContentAfterRenderRef?.destroy(),this._detachContentAfterRenderRef=void 0,this._detachContentMutationObserver?.disconnect()}_disposeScrollStrategy(){let i=this._scrollStrategy;i?.disable(),i?.detach?.()}},os="cdk-overlay-connected-position-bounding-box",io=/([A-Za-z%]+)$/;function xt(s,i){return new Tt(i,s.get(Ae),s.get(C),s.get(K),s.get(ms))}var Tt=class{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed;_boundingBox;_lastPosition;_lastScrollVisibility;_positionChanges=new T;_resizeSubscription=Ge.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount;positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(i,o,e,t,r){this._viewportRuler=o,this._document=e,this._platform=t,this._overlayContainer=r,this.setOrigin(i)}attach(i){this._overlayRef&&this._overlayRef,this._validatePositions(),i.hostElement.classList.add(os),this._overlayRef=i,this._boundingBox=i.hostElement,this._pane=i.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let i=this._originRect,o=this._overlayRect,e=this._viewportRect,t=this._containerRect,r=[],n;for(let a of this._preferredPositions){let c=this._getOriginPoint(i,t,a),h=this._getOverlayPoint(c,o,a),d=this._getOverlayFit(h,o,e,a);if(d.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(a,c);return}if(this._canFitWithFlexibleDimensions(d,h,e)){r.push({position:a,origin:c,overlayRect:o,boundingBoxRect:this._calculateBoundingBoxRect(c,a)});continue}(!n||n.overlayFit.visibleArea<d.visibleArea)&&(n={overlayFit:d,overlayPoint:h,originPoint:c,position:a,overlayRect:o})}if(r.length){let a=null,c=-1;for(let h of r){let d=h.boundingBoxRect.width*h.boundingBoxRect.height*(h.position.weight||1);d>c&&(c=d,a=h)}this._isPushed=!1,this._applyPosition(a.position,a.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(n.position,n.originPoint);return}this._applyPosition(n.position,n.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&ge(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(os),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let i=this._lastPosition;if(i){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let o=this._getOriginPoint(this._originRect,this._containerRect,i);this._applyPosition(i,o)}else this.apply()}withScrollableContainers(i){return this._scrollables=i,this}withPositions(i){return this._preferredPositions=i,i.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(i){return this._viewportMargin=i,this}withFlexibleDimensions(i=!0){return this._hasFlexibleDimensions=i,this}withGrowAfterOpen(i=!0){return this._growAfterOpen=i,this}withPush(i=!0){return this._canPush=i,this}withLockedPosition(i=!0){return this._positionLocked=i,this}setOrigin(i){return this._origin=i,this}withDefaultOffsetX(i){return this._offsetX=i,this}withDefaultOffsetY(i){return this._offsetY=i,this}withTransformOriginOn(i){return this._transformOriginSelector=i,this}_getOriginPoint(i,o,e){let t;if(e.originX=="center")t=i.left+i.width/2;else{let n=this._isRtl()?i.right:i.left,a=this._isRtl()?i.left:i.right;t=e.originX=="start"?n:a}o.left<0&&(t-=o.left);let r;return e.originY=="center"?r=i.top+i.height/2:r=e.originY=="top"?i.top:i.bottom,o.top<0&&(r-=o.top),{x:t,y:r}}_getOverlayPoint(i,o,e){let t;e.overlayX=="center"?t=-o.width/2:e.overlayX==="start"?t=this._isRtl()?-o.width:0:t=this._isRtl()?0:-o.width;let r;return e.overlayY=="center"?r=-o.height/2:r=e.overlayY=="top"?0:-o.height,{x:i.x+t,y:i.y+r}}_getOverlayFit(i,o,e,t){let r=ls(o),{x:n,y:a}=i,c=this._getOffset(t,"x"),h=this._getOffset(t,"y");c&&(n+=c),h&&(a+=h);let d=0-n,u=n+r.width-e.width,g=0-a,S=a+r.height-e.height,w=this._subtractOverflows(r.width,d,u),m=this._subtractOverflows(r.height,g,S),X=w*m;return{visibleArea:X,isCompletelyWithinViewport:r.width*r.height===X,fitsInViewportVertically:m===r.height,fitsInViewportHorizontally:w==r.width}}_canFitWithFlexibleDimensions(i,o,e){if(this._hasFlexibleDimensions){let t=e.bottom-o.y,r=e.right-o.x,n=as(this._overlayRef.getConfig().minHeight),a=as(this._overlayRef.getConfig().minWidth),c=i.fitsInViewportVertically||n!=null&&n<=t,h=i.fitsInViewportHorizontally||a!=null&&a<=r;return c&&h}return!1}_pushOverlayOnScreen(i,o,e){if(this._previousPushAmount&&this._positionLocked)return{x:i.x+this._previousPushAmount.x,y:i.y+this._previousPushAmount.y};let t=ls(o),r=this._viewportRect,n=Math.max(i.x+t.width-r.width,0),a=Math.max(i.y+t.height-r.height,0),c=Math.max(r.top-e.top-i.y,0),h=Math.max(r.left-e.left-i.x,0),d=0,u=0;return t.width<=r.width?d=h||-n:d=i.x<this._viewportMargin?r.left-e.left-i.x:0,t.height<=r.height?u=c||-a:u=i.y<this._viewportMargin?r.top-e.top-i.y:0,this._previousPushAmount={x:d,y:u},{x:i.x+d,y:i.y+u}}_applyPosition(i,o){if(this._setTransformOrigin(i),this._setOverlayElementStyles(o,i),this._setBoundingBoxStyles(o,i),i.panelClass&&this._addPanelClasses(i.panelClass),this._positionChanges.observers.length){let e=this._getScrollVisibility();if(i!==this._lastPosition||!this._lastScrollVisibility||!ro(this._lastScrollVisibility,e)){let t=new Pt(i,e);this._positionChanges.next(t)}this._lastScrollVisibility=e}this._lastPosition=i,this._isInitialRender=!1}_setTransformOrigin(i){if(!this._transformOriginSelector)return;let o=this._boundingBox.querySelectorAll(this._transformOriginSelector),e,t=i.overlayY;i.overlayX==="center"?e="center":this._isRtl()?e=i.overlayX==="start"?"right":"left":e=i.overlayX==="start"?"left":"right";for(let r=0;r<o.length;r++)o[r].style.transformOrigin=`${e} ${t}`}_calculateBoundingBoxRect(i,o){let e=this._viewportRect,t=this._isRtl(),r,n,a;if(o.overlayY==="top")n=i.y,r=e.height-n+this._viewportMargin;else if(o.overlayY==="bottom")a=e.height-i.y+this._viewportMargin*2,r=e.height-a+this._viewportMargin;else{let S=Math.min(e.bottom-i.y+e.top,i.y),w=this._lastBoundingBoxSize.height;r=S*2,n=i.y-S,r>w&&!this._isInitialRender&&!this._growAfterOpen&&(n=i.y-w/2)}let c=o.overlayX==="start"&&!t||o.overlayX==="end"&&t,h=o.overlayX==="end"&&!t||o.overlayX==="start"&&t,d,u,g;if(h)g=e.width-i.x+this._viewportMargin*2,d=i.x-this._viewportMargin;else if(c)u=i.x,d=e.right-i.x;else{let S=Math.min(e.right-i.x+e.left,i.x),w=this._lastBoundingBoxSize.width;d=S*2,u=i.x-S,d>w&&!this._isInitialRender&&!this._growAfterOpen&&(u=i.x-w/2)}return{top:n,left:u,bottom:a,right:g,width:d,height:r}}_setBoundingBoxStyles(i,o){let e=this._calculateBoundingBoxRect(i,o);!this._isInitialRender&&!this._growAfterOpen&&(e.height=Math.min(e.height,this._lastBoundingBoxSize.height),e.width=Math.min(e.width,this._lastBoundingBoxSize.width));let t={};if(this._hasExactPosition())t.top=t.left="0",t.bottom=t.right=t.maxHeight=t.maxWidth="",t.width=t.height="100%";else{let r=this._overlayRef.getConfig().maxHeight,n=this._overlayRef.getConfig().maxWidth;t.height=E(e.height),t.top=E(e.top),t.bottom=E(e.bottom),t.width=E(e.width),t.left=E(e.left),t.right=E(e.right),o.overlayX==="center"?t.alignItems="center":t.alignItems=o.overlayX==="end"?"flex-end":"flex-start",o.overlayY==="center"?t.justifyContent="center":t.justifyContent=o.overlayY==="bottom"?"flex-end":"flex-start",r&&(t.maxHeight=E(r)),n&&(t.maxWidth=E(n))}this._lastBoundingBoxSize=e,ge(this._boundingBox.style,t)}_resetBoundingBoxStyles(){ge(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){ge(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(i,o){let e={},t=this._hasExactPosition(),r=this._hasFlexibleDimensions,n=this._overlayRef.getConfig();if(t){let d=this._viewportRuler.getViewportScrollPosition();ge(e,this._getExactOverlayY(o,i,d)),ge(e,this._getExactOverlayX(o,i,d))}else e.position="static";let a="",c=this._getOffset(o,"x"),h=this._getOffset(o,"y");c&&(a+=`translateX(${c}px) `),h&&(a+=`translateY(${h}px)`),e.transform=a.trim(),n.maxHeight&&(t?e.maxHeight=E(n.maxHeight):r&&(e.maxHeight="")),n.maxWidth&&(t?e.maxWidth=E(n.maxWidth):r&&(e.maxWidth="")),ge(this._pane.style,e)}_getExactOverlayY(i,o,e){let t={top:"",bottom:""},r=this._getOverlayPoint(o,this._overlayRect,i);if(this._isPushed&&(r=this._pushOverlayOnScreen(r,this._overlayRect,e)),i.overlayY==="bottom"){let n=this._document.documentElement.clientHeight;t.bottom=`${n-(r.y+this._overlayRect.height)}px`}else t.top=E(r.y);return t}_getExactOverlayX(i,o,e){let t={left:"",right:""},r=this._getOverlayPoint(o,this._overlayRect,i);this._isPushed&&(r=this._pushOverlayOnScreen(r,this._overlayRect,e));let n;if(this._isRtl()?n=i.overlayX==="end"?"left":"right":n=i.overlayX==="end"?"right":"left",n==="right"){let a=this._document.documentElement.clientWidth;t.right=`${a-(r.x+this._overlayRect.width)}px`}else t.left=E(r.x);return t}_getScrollVisibility(){let i=this._getOriginRect(),o=this._pane.getBoundingClientRect(),e=this._scrollables.map(t=>t.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:ss(i,e),isOriginOutsideView:vi(i,e),isOverlayClipped:ss(o,e),isOverlayOutsideView:vi(o,e)}}_subtractOverflows(i,...o){return o.reduce((e,t)=>e-Math.max(t,0),i)}_getNarrowedViewportRect(){let i=this._document.documentElement.clientWidth,o=this._document.documentElement.clientHeight,e=this._viewportRuler.getViewportScrollPosition();return{top:e.top+this._viewportMargin,left:e.left+this._viewportMargin,right:e.left+i-this._viewportMargin,bottom:e.top+o-this._viewportMargin,width:i-2*this._viewportMargin,height:o-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(i,o){return o==="x"?i.offsetX==null?this._offsetX:i.offsetX:i.offsetY==null?this._offsetY:i.offsetY}_validatePositions(){}_addPanelClasses(i){this._pane&&Gt(i).forEach(o=>{o!==""&&this._appliedPanelClasses.indexOf(o)===-1&&(this._appliedPanelClasses.push(o),this._pane.classList.add(o))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(i=>{this._pane.classList.remove(i)}),this._appliedPanelClasses=[])}_getOriginRect(){let i=this._origin;if(i instanceof j)return i.nativeElement.getBoundingClientRect();if(i instanceof Element)return i.getBoundingClientRect();let o=i.width||0,e=i.height||0;return{top:i.y,bottom:i.y+e,left:i.x,right:i.x+o,height:e,width:o}}};function ge(s,i){for(let o in i)i.hasOwnProperty(o)&&(s[o]=i[o]);return s}function as(s){if(typeof s!="number"&&s!=null){let[i,o]=s.split(io);return!o||o==="px"?parseFloat(i):null}return s||null}function ls(s){return{top:Math.floor(s.top),right:Math.floor(s.right),bottom:Math.floor(s.bottom),left:Math.floor(s.left),width:Math.floor(s.width),height:Math.floor(s.height)}}function ro(s,i){return s===i?!0:s.isOriginClipped===i.isOriginClipped&&s.isOriginOutsideView===i.isOriginOutsideView&&s.isOverlayClipped===i.isOverlayClipped&&s.isOverlayOutsideView===i.isOverlayOutsideView}var cs="cdk-global-overlay-wrapper";function Ss(s){return new Ot}var Ot=class{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(i){let o=i.getConfig();this._overlayRef=i,this._width&&!o.width&&i.updateSize({width:this._width}),this._height&&!o.height&&i.updateSize({height:this._height}),i.hostElement.classList.add(cs),this._isDisposed=!1}top(i=""){return this._bottomOffset="",this._topOffset=i,this._alignItems="flex-start",this}left(i=""){return this._xOffset=i,this._xPosition="left",this}bottom(i=""){return this._topOffset="",this._bottomOffset=i,this._alignItems="flex-end",this}right(i=""){return this._xOffset=i,this._xPosition="right",this}start(i=""){return this._xOffset=i,this._xPosition="start",this}end(i=""){return this._xOffset=i,this._xPosition="end",this}width(i=""){return this._overlayRef?this._overlayRef.updateSize({width:i}):this._width=i,this}height(i=""){return this._overlayRef?this._overlayRef.updateSize({height:i}):this._height=i,this}centerHorizontally(i=""){return this.left(i),this._xPosition="center",this}centerVertically(i=""){return this.top(i),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let i=this._overlayRef.overlayElement.style,o=this._overlayRef.hostElement.style,e=this._overlayRef.getConfig(),{width:t,height:r,maxWidth:n,maxHeight:a}=e,c=(t==="100%"||t==="100vw")&&(!n||n==="100%"||n==="100vw"),h=(r==="100%"||r==="100vh")&&(!a||a==="100%"||a==="100vh"),d=this._xPosition,u=this._xOffset,g=this._overlayRef.getConfig().direction==="rtl",S="",w="",m="";c?m="flex-start":d==="center"?(m="center",g?w=u:S=u):g?d==="left"||d==="end"?(m="flex-end",S=u):(d==="right"||d==="start")&&(m="flex-start",w=u):d==="left"||d==="start"?(m="flex-start",S=u):(d==="right"||d==="end")&&(m="flex-end",w=u),i.position=this._cssPosition,i.marginLeft=c?"0":S,i.marginTop=h?"0":this._topOffset,i.marginBottom=this._bottomOffset,i.marginRight=c?"0":w,o.justifyContent=m,o.alignItems=h?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let i=this._overlayRef.overlayElement.style,o=this._overlayRef.hostElement,e=o.style;o.classList.remove(cs),e.justifyContent=e.alignItems=i.marginTop=i.marginBottom=i.marginLeft=i.marginRight=i.position="",this._overlayRef=null,this._isDisposed=!0}},ys=(()=>{class s{_injector=l(W);constructor(){}global(){return Ss()}flexibleConnectedTo(o){return xt(this._injector,o)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();function Mt(s,i){s.get(Qt).load(vs);let o=s.get(ms),e=s.get(C),t=s.get(cr),r=s.get(Ht),n=s.get(ht),a=e.createElement("div"),c=e.createElement("div");c.id=t.getId("cdk-overlay-"),c.classList.add("cdk-overlay-pane"),a.appendChild(c),o.getContainerElement().appendChild(a);let h=new Rt(c,r,s),d=new Et(i),u=s.get(Nt,null,{optional:!0})||s.get(J).createRenderer(null,null);return d.direction=d.direction||n.value,new At(h,a,c,d,s.get(M),s.get(ps),e,s.get(zi),s.get(gs),i?.disableAnimations??s.get(xi,null,{optional:!0})==="NoopAnimations",s.get(it),u)}var _s=(()=>{class s{scrollStrategies=l(us);_positionBuilder=l(ys);_injector=l(W);constructor(){}create(o){return Mt(this._injector,o)}position(){return this._positionBuilder}static \u0275fac=function(e){return new(e||s)};static \u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var so=new te("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let s=l(W);return()=>ve(s)}});function no(s){let i=l(W);return()=>ve(i)}var oo={provide:so,useFactory:no},Si=(()=>{class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=H({type:s});static \u0275inj=N({providers:[_s,oo],imports:[ze,is,fi,fi]})}return s})();var lo=["tooltip"],yi=20;var _i=new te("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let s=l(W);return()=>ve(s,{scrollThrottle:yi})}});function ks(s){let i=l(W);return()=>ve(i,{scrollThrottle:yi})}var wi={provide:_i,deps:[],useFactory:ks};function Rs(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}var Cs=new te("mat-tooltip-default-options",{providedIn:"root",factory:Rs});var ws="tooltip-panel",bs=nr({passive:!0}),co=8,ho=8,uo=24,fo=200,bi=(()=>{class s{_elementRef=l(j);_ngZone=l(M);_platform=l(K);_ariaDescriber=l(dr);_focusMonitor=l(ar);_dir=l(ht);_injector=l(W);_viewContainerRef=l(Ue);_animationsDisabled=Zt();_defaultOptions=l(Cs,{optional:!0});_overlayRef;_tooltipInstance;_overlayPanelClass;_portal;_position="below";_positionAtOrigin=!1;_disabled=!1;_tooltipClass;_viewInitialized=!1;_pointerExitEventsInitialized=!1;_tooltipComponent=Ds;_viewportMargin=8;_currentPosition;_cssClassPrefix="mat-mdc";_ariaDescriptionPending;_dirSubscribed=!1;get position(){return this._position}set position(o){o!==this._position&&(this._position=o,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(o){this._positionAtOrigin=ti(o),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(o){let e=ti(o);this._disabled!==e&&(this._disabled=e,e?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(o){this._showDelay=ct(o)}_showDelay;get hideDelay(){return this._hideDelay}set hideDelay(o){this._hideDelay=ct(o),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}_hideDelay;touchGestures="auto";get message(){return this._message}set message(o){let e=this._message;this._message=o!=null?String(o).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(e)}_message="";get tooltipClass(){return this._tooltipClass}set tooltipClass(o){this._tooltipClass=o,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}_passiveListeners=[];_touchstartTimeout=null;_destroyed=new T;_isDestroyed=!1;constructor(){let o=this._defaultOptions;o&&(this._showDelay=o.showDelay,this._hideDelay=o.hideDelay,o.position&&(this.position=o.position),o.positionAtOrigin&&(this.positionAtOrigin=o.positionAtOrigin),o.touchGestures&&(this.touchGestures=o.touchGestures),o.tooltipClass&&(this.tooltipClass=o.tooltipClass)),this._viewportMargin=co}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Z(this._destroyed)).subscribe(o=>{o?o==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){let o=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([e,t])=>{o.removeEventListener(e,t,bs)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._isDestroyed=!0,this._ariaDescriber.removeDescription(o,this.message,"tooltip"),this._focusMonitor.stopMonitoring(o)}show(o=this.showDelay,e){if(this.disabled||!this.message||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let t=this._createOverlay(e);this._detach(),this._portal=this._portal||new Xe(this._tooltipComponent,this._viewContainerRef);let r=this._tooltipInstance=t.attach(this._portal).instance;r._triggerElement=this._elementRef.nativeElement,r._mouseLeaveHideDelay=this._hideDelay,r.afterHidden().pipe(Z(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),r.show(o)}hide(o=this.hideDelay){let e=this._tooltipInstance;e&&(e.isVisible()?e.hide(o):(e._cancelPendingAnimations(),this._detach()))}toggle(o){this._isTooltipVisible()?this.hide():this.show(void 0,o)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(o){if(this._overlayRef){let n=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!o)&&n._origin instanceof j)return this._overlayRef;this._detach()}let e=this._injector.get(Pe).getAncestorScrollContainers(this._elementRef),t=`${this._cssClassPrefix}-${ws}`,r=xt(this._injector,this.positionAtOrigin?o||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(e);return r.positionChanges.pipe(Z(this._destroyed)).subscribe(n=>{this._updateCurrentPositionClass(n.connectionPair),this._tooltipInstance&&n.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=Mt(this._injector,{direction:this._dir,positionStrategy:r,panelClass:this._overlayPanelClass?[...this._overlayPanelClass,t]:t,scrollStrategy:this._injector.get(_i)(),disableAnimations:this._animationsDisabled}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Z(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Z(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Z(this._destroyed)).subscribe(n=>{this._isTooltipVisible()&&n.keyCode===27&&!hr(n)&&(n.preventDefault(),n.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._dirSubscribed||(this._dirSubscribed=!0,this._dir.change.pipe(Z(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(o){let e=o.getConfig().positionStrategy,t=this._getOrigin(),r=this._getOverlayPosition();e.withPositions([this._addOffset(y(y({},t.main),r.main)),this._addOffset(y(y({},t.fallback),r.fallback))])}_addOffset(o){let e=ho,t=!this._dir||this._dir.value=="ltr";return o.originY==="top"?o.offsetY=-e:o.originY==="bottom"?o.offsetY=e:o.originX==="start"?o.offsetX=t?-e:e:o.originX==="end"&&(o.offsetX=t?e:-e),o}_getOrigin(){let o=!this._dir||this._dir.value=="ltr",e=this.position,t;e=="above"||e=="below"?t={originX:"center",originY:e=="above"?"top":"bottom"}:e=="before"||e=="left"&&o||e=="right"&&!o?t={originX:"start",originY:"center"}:(e=="after"||e=="right"&&o||e=="left"&&!o)&&(t={originX:"end",originY:"center"});let{x:r,y:n}=this._invertPosition(t.originX,t.originY);return{main:t,fallback:{originX:r,originY:n}}}_getOverlayPosition(){let o=!this._dir||this._dir.value=="ltr",e=this.position,t;e=="above"?t={overlayX:"center",overlayY:"bottom"}:e=="below"?t={overlayX:"center",overlayY:"top"}:e=="before"||e=="left"&&o||e=="right"&&!o?t={overlayX:"end",overlayY:"center"}:(e=="after"||e=="right"&&o||e=="left"&&!o)&&(t={overlayX:"start",overlayY:"center"});let{x:r,y:n}=this._invertPosition(t.overlayX,t.overlayY);return{main:t,fallback:{overlayX:r,overlayY:n}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),de(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(o){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=o,this._tooltipInstance._markForCheck())}_invertPosition(o,e){return this.position==="above"||this.position==="below"?e==="top"?e="bottom":e==="bottom"&&(e="top"):o==="end"?o="start":o==="start"&&(o="end"),{x:o,y:e}}_updateCurrentPositionClass(o){let{overlayY:e,originX:t,originY:r}=o,n;if(e==="center"?this._dir&&this._dir.value==="rtl"?n=t==="end"?"left":"right":n=t==="start"?"left":"right":n=e==="bottom"&&r==="top"?"above":"below",n!==this._currentPosition){let a=this._overlayRef;if(a){let c=`${this._cssClassPrefix}-${ws}-`;a.removePanelClass(c+this._currentPosition),a.addPanelClass(c+n)}this._currentPosition=n}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",o=>{this._setupPointerExitEventsIfNeeded();let e;o.x!==void 0&&o.y!==void 0&&(e=o),this.show(void 0,e)}]):this.touchGestures!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",o=>{let e=o.targetTouches?.[0],t=e?{x:e.clientX,y:e.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout);let r=500;this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,t)},this._defaultOptions?.touchLongPressShowDelay??r)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let o=[];if(this._platformSupportsMouseEvents())o.push(["mouseleave",e=>{let t=e.relatedTarget;(!t||!this._overlayRef?.overlayElement.contains(t))&&this.hide()}],["wheel",e=>this._wheelListener(e)]);else if(this.touchGestures!=="off"){this._disableNativeGesturesIfNecessary();let e=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions?.touchendHideDelay)};o.push(["touchend",e],["touchcancel",e])}this._addListeners(o),this._passiveListeners.push(...o)}_addListeners(o){o.forEach(([e,t])=>{this._elementRef.nativeElement.addEventListener(e,t,bs)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(o){if(this._isTooltipVisible()){let e=this._injector.get(C).elementFromPoint(o.clientX,o.clientY),t=this._elementRef.nativeElement;e!==t&&!t.contains(e)&&this.hide()}}_disableNativeGesturesIfNecessary(){let o=this.touchGestures;if(o!=="off"){let e=this._elementRef.nativeElement,t=e.style;(o==="on"||e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA")&&(t.userSelect=t.msUserSelect=t.webkitUserSelect=t.MozUserSelect="none"),(o==="on"||!e.draggable)&&(t.webkitUserDrag="none"),t.touchAction="none",t.webkitTapHighlightColor="transparent"}}_syncAriaDescription(o){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,o,"tooltip"),this._isDestroyed||de({write:()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")}},{injector:this._injector}))}static \u0275fac=function(e){return new(e||s)};static \u0275dir=he({type:s,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(e,t){e&2&&we("mat-mdc-tooltip-disabled",t.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]})}return s})(),Ds=(()=>{class s{_changeDetectorRef=l(Xt);_elementRef=l(j);_isMultiline=!1;message;tooltipClass;_showTimeoutId;_hideTimeoutId;_triggerElement;_mouseLeaveHideDelay;_animationsDisabled=Zt();_tooltip;_closeOnInteraction=!1;_isVisible=!1;_onHide=new T;_showAnimation="mat-mdc-tooltip-show";_hideAnimation="mat-mdc-tooltip-hide";constructor(){}show(o){this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},o)}hide(o){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},o)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:o}){(!o||!this._triggerElement.contains(o))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){let o=this._elementRef.nativeElement.getBoundingClientRect();return o.height>uo&&o.width>=fo}_handleAnimationEnd({animationName:o}){(o===this._showAnimation||o===this._hideAnimation)&&this._finalizeAnimation(o===this._showAnimation)}_cancelPendingAnimations(){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(o){o?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(o){let e=this._tooltip.nativeElement,t=this._showAnimation,r=this._hideAnimation;if(e.classList.remove(o?r:t),e.classList.add(o?t:r),this._isVisible!==o&&(this._isVisible=o,this._changeDetectorRef.markForCheck()),o&&!this._animationsDisabled&&typeof getComputedStyle=="function"){let n=getComputedStyle(e);(n.getPropertyValue("animation-duration")==="0s"||n.getPropertyValue("animation-name")==="none")&&(this._animationsDisabled=!0)}o&&this._onShow(),this._animationsDisabled&&(e.classList.add("_mat-animation-noopable"),this._finalizeAnimation(o))}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=V({type:s,selectors:[["mat-tooltip-component"]],viewQuery:function(e,t){if(e&1&&$t(lo,7),e&2){let r;Ne(r=He())&&(t._tooltip=r.first)}},hostAttrs:["aria-hidden","true"],hostBindings:function(e,t){e&1&&re("mouseleave",function(n){return t._handleMouseLeave(n)})},decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(e,t){if(e&1){let r=Le();B(0,"div",1,0),re("animationend",function(a){return Me(r),Fe(t._handleAnimationEnd(a))}),B(2,"div",2),Q(3),q()()}e&2&&(we("mdc-tooltip--multiline",t._isMultiline),ye("ngClass",t.tooltipClass),ie(3),Vi(t.message))},dependencies:[ji],styles:[`.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mat-tooltip-container-color, var(--mat-sys-inverse-surface));color:var(--mat-tooltip-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mat-tooltip-container-shape, var(--mat-sys-corner-extra-small));font-family:var(--mat-tooltip-supporting-text-font, var(--mat-sys-body-small-font));font-size:var(--mat-tooltip-supporting-text-size, var(--mat-sys-body-small-size));font-weight:var(--mat-tooltip-supporting-text-weight, var(--mat-sys-body-small-weight));line-height:var(--mat-tooltip-supporting-text-line-height, var(--mat-sys-body-small-line-height));letter-spacing:var(--mat-tooltip-supporting-text-tracking, var(--mat-sys-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel{line-height:normal}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}
`],encapsulation:2,changeDetection:0})}return s})();var ki=(()=>{class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=H({type:s});static \u0275inj=N({providers:[wi],imports:[lr,Si,Re,Re,Ke]})}return s})();function go(s,i){s&1&&(B(0,"button",2),Q(1," Neuen Blog erstellen "),q())}function vo(s,i){if(s&1){let o=Le();_e(0,"div",4),B(1,"button",5),re("click",function(){Me(o);let t=st();return Fe(t.logout.emit())}),B(2,"mat-icon"),Q(3,"logout"),q()()}if(s&2){let o,e=st();ye("matTooltip",Li((o=e.userData())==null?null:o.preferred_username))("innerHTML",e.initials(),Mi)}}function mo(s,i){if(s&1){let o=Le();B(0,"button",6),re("click",function(){Me(o);let t=st();return Fe(t.login.emit())}),B(1,"mat-icon"),Q(2,"login"),q()()}}var Ft=class s{isAuthenticated=ot.required();roles=ot.required();userData=ot.required();login=Yt();logout=Yt();initials=$(()=>this.userData()?.preferred_username.split(/[._-]/).map(i=>i.charAt(0)).join(""));canAddBlog=$(()=>{let i=this.isAuthenticated(),o=this.roles();return i&&o?.includes("user")});static \u0275fac=function(o){return new(o||s)};static \u0275cmp=V({type:s,selectors:[["BlogHeader"]],inputs:{isAuthenticated:[1,"isAuthenticated"],roles:[1,"roles"],userData:[1,"userData"]},outputs:{login:"login",logout:"logout"},decls:7,vars:2,consts:[["color","primary",1,"header-toolbar"],[1,"spacer"],["mat-raised-button","","color","accent","routerLink","/add-blog",1,"add-blog"],["data-testid","login-button","mat-icon-button","","matTooltip","Login","aria-label","Login button",1,"example-icon","favorite-icon"],["id","profileImage",3,"matTooltip","innerHTML"],["data-testid","logout-button","mat-icon-button","","matTooltip","Logout","aria-label","Logout button",1,"example-icon","favorite-icon",3,"click"],["data-testid","login-button","mat-icon-button","","matTooltip","Login","aria-label","Login button",1,"example-icon","favorite-icon",3,"click"]],template:function(o,e){o&1&&(B(0,"mat-toolbar",0)(1,"span"),Q(2,"Blog App"),q(),_e(3,"span",1),We(4,go,2,0,"button",2),We(5,vo,4,3)(6,mo,3,0,"button",3),q()),o&2&&(ie(4),Ve(e.canAddBlog()?4:-1),ie(),Ve(e.isAuthenticated()?5:6))},dependencies:[ir,es,Qr,Sr,mr,vr,gr,pr,ki,bi],styles:["[_nghost-%COMP%]{height:4rem;display:block}[_nghost-%COMP%]   .header-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:0 1rem;position:fixed;z-index:1000}[_nghost-%COMP%]   #profileImage[_ngcontent-%COMP%]{width:2.1875rem;height:2.1875rem;border-radius:20px;background:#0c2354;font-size:.9rem;color:#fff;text-align:center;line-height:2.1875rem;text-transform:uppercase;cursor:pointer}[_nghost-%COMP%]   .add-blog[_ngcontent-%COMP%]{margin-right:1rem}[_nghost-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:1}"],changeDetection:0})};function So(s,i){s&1&&_e(0,"mat-progress-bar",1)}var Ut=class s{isLoading=l(bt).isLoading;#e=l(Ee);onModeChange(i){console.log(`event fired ${i}`)}title="blogapp-20";isAuthenticated=this.#e.isAuthenticated;userData=this.#e.userData;roles=this.#e.roles;login(){this.#e.login()}logout(){this.#e.logout()}static \u0275fac=function(o){return new(o||s)};static \u0275cmp=V({type:s,selectors:[["App"]],decls:3,vars:4,consts:[[3,"login","logout","isAuthenticated","roles","userData"],["mode","indeterminate"]],template:function(o,e){o&1&&(B(0,"BlogHeader",0),re("login",function(){return e.login()})("logout",function(){return e.logout()}),q(),We(1,So,1,0,"mat-progress-bar",1),_e(2,"router-outlet")),o&2&&(ye("isAuthenticated",e.isAuthenticated())("roles",e.roles())("userData",e.userData()),ie(),Ve(e.isLoading()?1:-1))},dependencies:[tr,Ft,ur],encapsulation:2})};Ki(Ut,Jr).catch(s=>console.error(s));
